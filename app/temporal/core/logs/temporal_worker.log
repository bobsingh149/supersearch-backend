2025-03-02 17:22:34,193 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 17:22:34,194 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 17:22:34,356 [INFO] Connected to Temporal server
2025-03-02 17:22:34,356 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-02 17:22:35,714 [WARNING] __call__ on pathlib.Path.expanduser restricted
2025-03-02 17:27:07,404 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 17:27:07,405 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 17:27:07,433 [INFO] Connected to Temporal server
2025-03-02 17:27:07,434 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-02 17:27:08,225 [WARNING] __call__ on pathlib.Path.expanduser restricted
2025-03-02 17:33:58,647 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 17:33:58,648 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 17:33:58,665 [INFO] Connected to Temporal server
2025-03-02 17:33:58,665 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-02 17:33:59,370 [WARNING] __call__ on pathlib.Path.expanduser restricted
2025-03-02 17:35:08,606 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 17:35:08,607 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 17:35:08,621 [INFO] Connected to Temporal server
2025-03-02 17:35:08,621 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-02 17:35:09,359 [WARNING] __call__ on pathlib.Path.expanduser restricted
2025-03-02 18:27:19,978 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 18:27:19,978 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 18:27:20,039 [INFO] Connected to Temporal server
2025-03-02 18:27:20,039 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-02 18:27:20,915 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-02 18:27:20,915 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-02 18:31:11,576 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 18:31:11,576 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 18:31:11,587 [INFO] Connected to Temporal server
2025-03-02 18:31:11,588 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-02 18:31:12,434 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-02 18:31:12,434 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-02 18:31:12,434 [INFO] Starting worker...
2025-03-02 18:32:28,066 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 18:32:28,067 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-02 18:32:28,078 [INFO] Connected to Temporal server
2025-03-02 18:32:28,078 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-02 18:32:28,952 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-02 18:32:28,952 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-02 18:32:28,952 [INFO] Started worker
2025-03-03 00:27:36,993 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-03 00:27:36,993 [INFO] Connecting to Temporal server at localhost:7233 with namespace development
2025-03-03 00:27:37,080 [INFO] Connected to Temporal server
2025-03-03 00:27:37,081 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-03 00:27:38,724 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-03 00:27:38,724 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-03 00:27:38,724 [INFO] Started worker
2025-03-03 01:04:04,382 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-03 01:04:04,383 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-03 01:04:04,399 [INFO] Connected to Temporal server
2025-03-03 01:04:04,399 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-03 01:04:06,684 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-03 01:04:06,685 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-03 01:04:06,685 [INFO] Started worker with task queue product-sync-task-queue
2025-03-03 01:04:06,875 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-03 01:04:06,876 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f', 'workflow_run_id': '01955853-c717-7825-b429-962daeb99065', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-03 01:04:07,967 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-03 01:04:07,968 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f', 'workflow_run_id': '01955853-c717-7825-b429-962daeb99065', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-03 01:04:10,045 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-03 01:04:10,046 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f', 'workflow_run_id': '01955853-c717-7825-b429-962daeb99065', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-03 01:04:10,138 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f and run ID 01955853-c717-7825-b429-962daeb99065
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:04:10,306 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f and run ID 01955853-c717-7825-b429-962daeb99065
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:04:10,412 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f and run ID 01955853-c717-7825-b429-962daeb99065
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:04:20,437 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f and run ID 01955853-c717-7825-b429-962daeb99065
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:04:30,459 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f and run ID 01955853-c717-7825-b429-962daeb99065
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:04:45,154 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f and run ID 01955853-c717-7825-b429-962daeb99065
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:05:03,479 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-492fe253-3263-40be-aa8a-9eb3bf13e77f and run ID 01955853-c717-7825-b429-962daeb99065
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:05:03,863 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-03 01:05:58,252 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-03 01:05:58,253 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-03 01:05:58,265 [INFO] Connected to Temporal server
2025-03-03 01:05:58,265 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-03 01:06:00,292 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-03 01:06:00,292 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-03 01:06:00,293 [INFO] Started worker with task queue product-sync-task-queue
2025-03-03 01:06:42,646 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-03 01:06:42,646 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-7f702f49-526f-4385-8b31-5239f234ab08', 'workflow_run_id': '0195585c-5b1c-74e5-9b58-ed62e8044234', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-03 01:06:43,747 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-03 01:06:43,747 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-7f702f49-526f-4385-8b31-5239f234ab08', 'workflow_run_id': '0195585c-5b1c-74e5-9b58-ed62e8044234', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-03 01:06:45,805 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-03 01:06:45,805 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-7f702f49-526f-4385-8b31-5239f234ab08', 'workflow_run_id': '0195585c-5b1c-74e5-9b58-ed62e8044234', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-03 01:06:45,883 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7f702f49-526f-4385-8b31-5239f234ab08 and run ID 0195585c-5b1c-74e5-9b58-ed62e8044234
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:06:45,995 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7f702f49-526f-4385-8b31-5239f234ab08 and run ID 0195585c-5b1c-74e5-9b58-ed62e8044234
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:06:46,090 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7f702f49-526f-4385-8b31-5239f234ab08 and run ID 0195585c-5b1c-74e5-9b58-ed62e8044234
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:06:56,108 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7f702f49-526f-4385-8b31-5239f234ab08 and run ID 0195585c-5b1c-74e5-9b58-ed62e8044234
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:07:06,127 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7f702f49-526f-4385-8b31-5239f234ab08 and run ID 0195585c-5b1c-74e5-9b58-ed62e8044234
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:07:20,211 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7f702f49-526f-4385-8b31-5239f234ab08 and run ID 0195585c-5b1c-74e5-9b58-ed62e8044234
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:07:50,622 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-03 01:07:50,622 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-619ceb6a-1acf-4750-aaf8-095547dd018d', 'workflow_run_id': '0195585d-647e-74b0-9418-43928c330f97', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-03 01:07:51,712 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-03 01:07:51,712 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-619ceb6a-1acf-4750-aaf8-095547dd018d', 'workflow_run_id': '0195585d-647e-74b0-9418-43928c330f97', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-03 01:07:53,794 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-03 01:07:53,796 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-619ceb6a-1acf-4750-aaf8-095547dd018d', 'workflow_run_id': '0195585d-647e-74b0-9418-43928c330f97', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-03 01:07:53,892 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-619ceb6a-1acf-4750-aaf8-095547dd018d and run ID 0195585d-647e-74b0-9418-43928c330f97
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:07:53,989 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-619ceb6a-1acf-4750-aaf8-095547dd018d and run ID 0195585d-647e-74b0-9418-43928c330f97
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:07:54,087 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-619ceb6a-1acf-4750-aaf8-095547dd018d and run ID 0195585d-647e-74b0-9418-43928c330f97
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:08:04,111 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-619ceb6a-1acf-4750-aaf8-095547dd018d and run ID 0195585d-647e-74b0-9418-43928c330f97
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:08:14,116 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-619ceb6a-1acf-4750-aaf8-095547dd018d and run ID 0195585d-647e-74b0-9418-43928c330f97
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 01:08:28,374 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-619ceb6a-1acf-4750-aaf8-095547dd018d and run ID 0195585d-647e-74b0-9418-43928c330f97
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-03 13:48:41,511 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-05 23:07:58,500 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-05 23:07:58,501 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-05 23:07:58,565 [INFO] Connected to Temporal server
2025-03-05 23:07:58,567 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-05 23:07:59,573 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-05 23:07:59,573 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-05 23:07:59,573 [INFO] Started worker with task queue product-sync-task-queue
2025-03-05 23:12:03,213 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:12:03,213 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba', 'workflow_run_id': '01956766-764e-73c2-b54b-617f160c4248', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-05 23:12:04,266 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:12:04,267 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba', 'workflow_run_id': '01956766-764e-73c2-b54b-617f160c4248', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-05 23:12:06,321 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:12:06,321 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba', 'workflow_run_id': '01956766-764e-73c2-b54b-617f160c4248', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 50, in create_sync_history
    async with get_async_session() as session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-05 23:12:06,397 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:12:06,535 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:12:06,599 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:12:16,622 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:12:26,657 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:12:41,270 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:13:00,110 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:13:26,934 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:14:13,987 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:15:28,260 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:18:17,003 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-54578f42-7606-421c-92b1-800fac22d4ba and run ID 01956766-764e-73c2-b54b-617f160c4248
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:20:41,281 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-05 23:20:46,506 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-05 23:20:46,507 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-05 23:20:46,514 [INFO] Connected to Temporal server
2025-03-05 23:20:46,514 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-05 23:20:47,604 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-05 23:20:47,605 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-05 23:20:47,605 [INFO] Started worker with task queue product-sync-task-queue
2025-03-05 23:21:01,565 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:21:01,708 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-babdd418-74ac-427d-a55a-b26c2a6da156', 'workflow_run_id': '0195676e-ad52-7cba-b5cf-c2d1516b61a4', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedObjectError: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 61, in create_sync_history
    await session.flush()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::syncsource, $3::syncstatus, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('447abbb1-9ca2-4b0c-868d-735b74a36752'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 17, 51, 1, 676694, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 17, 51, 1, 693423), datetime.datetime(2025, 3, 5, 17, 51, 1, 693423))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-05 23:21:03,140 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:21:03,146 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-babdd418-74ac-427d-a55a-b26c2a6da156', 'workflow_run_id': '0195676e-ad52-7cba-b5cf-c2d1516b61a4', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedObjectError: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 61, in create_sync_history
    await session.flush()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::syncsource, $3::syncstatus, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('27a86d94-6936-42fd-84d5-fcb2bbeba623'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 17, 51, 3, 143660, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 17, 51, 3, 143660), datetime.datetime(2025, 3, 5, 17, 51, 3, 143660))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-05 23:21:05,219 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:21:05,269 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-babdd418-74ac-427d-a55a-b26c2a6da156', 'workflow_run_id': '0195676e-ad52-7cba-b5cf-c2d1516b61a4', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedObjectError: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 61, in create_sync_history
    await session.flush()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::syncsource, $3::syncstatus, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('d064138d-559c-4ec5-a7c6-690e8b6c3eeb'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 17, 51, 5, 219372, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 17, 51, 5, 219372), datetime.datetime(2025, 3, 5, 17, 51, 5, 219372))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-05 23:21:05,512 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-babdd418-74ac-427d-a55a-b26c2a6da156 and run ID 0195676e-ad52-7cba-b5cf-c2d1516b61a4
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::syncsource, $3::syncstatus, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('d064138d-559c-4ec5-a7c6-690e8b6c3eeb'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 17, 51, 5, 219372, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 17, 51, 5, 219372), datetime.datetime(2025, 3, 5, 17, 51, 5, 219372))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:21:05,604 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-babdd418-74ac-427d-a55a-b26c2a6da156 and run ID 0195676e-ad52-7cba-b5cf-c2d1516b61a4
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::syncsource, $3::syncstatus, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('d064138d-559c-4ec5-a7c6-690e8b6c3eeb'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 17, 51, 5, 219372, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 17, 51, 5, 219372), datetime.datetime(2025, 3, 5, 17, 51, 5, 219372))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:21:05,671 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-babdd418-74ac-427d-a55a-b26c2a6da156 and run ID 0195676e-ad52-7cba-b5cf-c2d1516b61a4
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::syncsource, $3::syncstatus, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('d064138d-559c-4ec5-a7c6-690e8b6c3eeb'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 17, 51, 5, 219372, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 17, 51, 5, 219372), datetime.datetime(2025, 3, 5, 17, 51, 5, 219372))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:21:15,675 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-babdd418-74ac-427d-a55a-b26c2a6da156 and run ID 0195676e-ad52-7cba-b5cf-c2d1516b61a4
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::syncsource, $3::syncstatus, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('d064138d-559c-4ec5-a7c6-690e8b6c3eeb'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 17, 51, 5, 219372, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 17, 51, 5, 219372), datetime.datetime(2025, 3, 5, 17, 51, 5, 219372))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:21:25,682 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-babdd418-74ac-427d-a55a-b26c2a6da156 and run ID 0195676e-ad52-7cba-b5cf-c2d1516b61a4
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::syncsource, $3::syncstatus, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('d064138d-559c-4ec5-a7c6-690e8b6c3eeb'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 17, 51, 5, 219372, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 17, 51, 5, 219372), datetime.datetime(2025, 3, 5, 17, 51, 5, 219372))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:21:29,736 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-05 23:55:35,858 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-05 23:55:35,858 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-05 23:55:35,868 [INFO] Connected to Temporal server
2025-03-05 23:55:35,868 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-05 23:55:37,068 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-05 23:55:37,068 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-05 23:55:37,068 [INFO] Started worker with task queue product-sync-task-queue
2025-03-05 23:55:37,109 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-babdd418-74ac-427d-a55a-b26c2a6da156 and run ID 0195676e-ad52-7cba-b5cf-c2d1516b61a4
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "syncsource" does not exist
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::syncsource, $3::syncstatus, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('d064138d-559c-4ec5-a7c6-690e8b6c3eeb'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 17, 51, 5, 219372, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 17, 51, 5, 219372), datetime.datetime(2025, 3, 5, 17, 51, 5, 219372))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:56:01,372 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:56:01,503 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4', 'workflow_run_id': '0195678e-b7a8-7063-819f-29916ca8ce14', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 65, in create_sync_history
    await session.flush()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('20291fe8-054a-4e12-b176-12823fe97db7'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 1, 487930, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 1, 487930), datetime.datetime(2025, 3, 5, 18, 26, 1, 487930))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-05 23:56:02,571 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:56:02,583 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4', 'workflow_run_id': '0195678e-b7a8-7063-819f-29916ca8ce14', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 65, in create_sync_history
    await session.flush()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('e21f3896-e9e9-4dd9-9da9-90be9a1adaf5'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 2, 571165, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 2, 571165), datetime.datetime(2025, 3, 5, 18, 26, 2, 571165))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-05 23:56:04,634 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:56:04,634 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4', 'workflow_run_id': '0195678e-b7a8-7063-819f-29916ca8ce14', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 65, in create_sync_history
    await session.flush()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('342bc800-9f85-4cc9-b2cd-e784e47d2c8c'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 4, 634688, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 4, 634688), datetime.datetime(2025, 3, 5, 18, 26, 4, 634688))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-05 23:56:04,694 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4 and run ID 0195678e-b7a8-7063-819f-29916ca8ce14
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('342bc800-9f85-4cc9-b2cd-e784e47d2c8c'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 4, 634688, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 4, 634688), datetime.datetime(2025, 3, 5, 18, 26, 4, 634688))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:56:04,787 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4 and run ID 0195678e-b7a8-7063-819f-29916ca8ce14
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('342bc800-9f85-4cc9-b2cd-e784e47d2c8c'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 4, 634688, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 4, 634688), datetime.datetime(2025, 3, 5, 18, 26, 4, 634688))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:56:04,849 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4 and run ID 0195678e-b7a8-7063-819f-29916ca8ce14
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('342bc800-9f85-4cc9-b2cd-e784e47d2c8c'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 4, 634688, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 4, 634688), datetime.datetime(2025, 3, 5, 18, 26, 4, 634688))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:56:14,857 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4 and run ID 0195678e-b7a8-7063-819f-29916ca8ce14
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('342bc800-9f85-4cc9-b2cd-e784e47d2c8c'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 4, 634688, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 4, 634688), datetime.datetime(2025, 3, 5, 18, 26, 4, 634688))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:56:24,877 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4 and run ID 0195678e-b7a8-7063-819f-29916ca8ce14
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('342bc800-9f85-4cc9-b2cd-e784e47d2c8c'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 4, 634688, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 4, 634688), datetime.datetime(2025, 3, 5, 18, 26, 4, 634688))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:56:39,466 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4 and run ID 0195678e-b7a8-7063-819f-29916ca8ce14
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('342bc800-9f85-4cc9-b2cd-e784e47d2c8c'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 4, 634688, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 4, 634688), datetime.datetime(2025, 3, 5, 18, 26, 4, 634688))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:56:59,384 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b1b78138-203b-453b-9e7d-6d773e17dce4 and run ID 0195678e-b7a8-7063-819f-29916ca8ce14
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('342bc800-9f85-4cc9-b2cd-e784e47d2c8c'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 26, 4, 634688, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 26, 4, 634688), datetime.datetime(2025, 3, 5, 18, 26, 4, 634688))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:57:00,001 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-05 23:57:04,674 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-05 23:57:04,674 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-05 23:57:04,685 [INFO] Connected to Temporal server
2025-03-05 23:57:04,685 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-05 23:57:05,799 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-05 23:57:05,799 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-05 23:57:05,799 [INFO] Started worker with task queue product-sync-task-queue
2025-03-05 23:57:40,894 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:57:40,954 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a', 'workflow_run_id': '01956790-3c75-77ea-8b44-3e1b73cb906b', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 65, in create_sync_history
    await session.flush()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('b425f1d3-6edd-40b7-86c9-19384ba1505b'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 40, 939332, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 40, 939332), datetime.datetime(2025, 3, 5, 18, 27, 40, 939332))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-05 23:57:41,978 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:57:41,978 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a', 'workflow_run_id': '01956790-3c75-77ea-8b44-3e1b73cb906b', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 65, in create_sync_history
    await session.flush()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('e42043cd-3731-4429-963b-9fa9dfd4997e'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 41, 978675, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 41, 978675), datetime.datetime(2025, 3, 5, 18, 27, 41, 978675))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-05 23:57:44,047 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-05 23:57:44,049 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a', 'workflow_run_id': '01956790-3c75-77ea-8b44-3e1b73cb906b', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 65, in create_sync_history
    await session.flush()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 802, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4353, in flush
    self._flush(objects)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    with util.safe_reraise():
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4449, in _flush
    flush_context.execute()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-05 23:57:44,112 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:57:44,198 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:57:44,274 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:57:54,282 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:58:04,310 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:58:18,820 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:58:38,160 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:59:06,093 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-05 23:59:55,170 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-06 00:01:19,972 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-06 00:03:45,527 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-06 00:08:51,430 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0e118b4d-1ffe-490c-acb7-8be4f218b11a and run ID 01956790-3c75-77ea-8b44-3e1b73cb906b
temporalio.exceptions.ApplicationError: DatatypeMismatchError: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.DatatypeMismatchError'>: column "id" is of type uuid but expression is of type character varying
HINT:  You will need to rewrite or cast the expression.
[SQL: INSERT INTO sync_history (id, source, status, start_time, end_time, records_processed, next_run, created_at, updated_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE, $5::TIMESTAMP WITH TIME ZONE, $6::INTEGER, $7::TIMESTAMP WITH TIME ZONE, $8::TIMESTAMP WITH TIME ZONE, $9::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('8f9d0fc7-0fae-4266-a396-16e1fb02a7aa'), 'MANUAL_FILE_UPLOAD', 'PROCESSING', datetime.datetime(2025, 3, 5, 18, 27, 44, 49345, tzinfo=datetime.timezone.utc), None, None, None, datetime.datetime(2025, 3, 5, 18, 27, 44, 49345), datetime.datetime(2025, 3, 5, 18, 27, 44, 49345))]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-06 00:18:27,700 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-06 00:18:32,880 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-06 00:18:32,881 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-06 00:18:32,890 [INFO] Connected to Temporal server
2025-03-06 00:18:32,890 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-06 00:18:34,148 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-06 00:18:34,149 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-06 00:18:34,149 [INFO] Started worker with task queue product-sync-task-queue
2025-03-06 00:18:48,250 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-06 00:18:48,383 [INFO] Created sync history record with ID: 08159803-9414-4f34-a67a-c1c6bc187a82
2025-03-06 00:18:48,468 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-06 00:18:49,193 [INFO] Total embedding process completed in 0.725s
2025-03-06 00:18:49,631 [INFO] Total embedding process completed in 0.439s
2025-03-06 00:18:50,063 [INFO] Total embedding process completed in 0.431s
2025-03-06 00:18:50,063 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-06 00:18:50,145 [INFO] Inserting 3 products into database
2025-03-06 00:18:50,359 [INFO] Inserted 3 products into database
2025-03-06 00:18:50,446 [INFO] Updating sync history record with ID: 08159803-9414-4f34-a67a-c1c6bc187a82
2025-03-06 00:18:50,476 [INFO] Updated sync history record with ID: 08159803-9414-4f34-a67a-c1c6bc187a82
2025-03-06 00:46:15,074 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-06 00:46:15,106 [INFO] Created sync history record with ID: cf2e60bc-55f9-4f88-a345-0f0dc8ce5b12
2025-03-06 00:46:15,208 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-06 00:46:15,940 [INFO] Total embedding process completed in 0.732s
2025-03-06 00:46:16,335 [INFO] Total embedding process completed in 0.394s
2025-03-06 00:46:16,784 [INFO] Total embedding process completed in 0.448s
2025-03-06 00:46:16,784 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-06 00:46:16,874 [INFO] Inserting 3 products into database
2025-03-06 00:46:16,930 [INFO] Inserted 3 products into database
2025-03-06 00:46:17,025 [INFO] Updating sync history record with ID: cf2e60bc-55f9-4f88-a345-0f0dc8ce5b12
2025-03-06 00:46:17,072 [INFO] Updated sync history record with ID: cf2e60bc-55f9-4f88-a345-0f0dc8ce5b12
2025-03-07 23:51:58,384 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-07 23:51:58,385 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-07 23:51:58,440 [INFO] Connected to Temporal server
2025-03-07 23:51:58,441 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-07 23:52:00,089 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-07 23:52:00,089 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-07 23:52:00,089 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 00:10:17,300 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 00:10:17,574 [INFO] Created sync history record with ID: fa2a732a-e8c8-4da6-a2ee-327d59411b07
2025-03-08 00:10:17,574 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f', 'workflow_run_id': '019571e8-7e92-7021-99b8-c9797790de8d', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 71, in create_sync_history
    return CreateSyncHistoryOutput(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-03-08 00:10:18,680 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 00:10:18,680 [INFO] Created sync history record with ID: 5c0b580e-c8f1-4a91-8960-df9aecbae994
2025-03-08 00:10:18,680 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f', 'workflow_run_id': '019571e8-7e92-7021-99b8-c9797790de8d', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 71, in create_sync_history
    return CreateSyncHistoryOutput(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-03-08 00:10:20,742 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 00:10:20,753 [INFO] Created sync history record with ID: 65d5ce6b-6750-490c-9b7f-6c1f37292201
2025-03-08 00:10:20,753 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f', 'workflow_run_id': '019571e8-7e92-7021-99b8-c9797790de8d', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 71, in create_sync_history
    return CreateSyncHistoryOutput(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-03-08 00:10:20,827 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f and run ID 019571e8-7e92-7021-99b8-c9797790de8d
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:10:20,970 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f and run ID 019571e8-7e92-7021-99b8-c9797790de8d
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:10:21,031 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f and run ID 019571e8-7e92-7021-99b8-c9797790de8d
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:10:31,038 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f and run ID 019571e8-7e92-7021-99b8-c9797790de8d
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:10:41,052 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f and run ID 019571e8-7e92-7021-99b8-c9797790de8d
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:10:55,334 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f and run ID 019571e8-7e92-7021-99b8-c9797790de8d
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:11:13,526 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f and run ID 019571e8-7e92-7021-99b8-c9797790de8d
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:11:41,878 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f and run ID 019571e8-7e92-7021-99b8-c9797790de8d
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:12:26,828 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-03bf5fb5-abcd-4cb4-b879-5b47e857904f and run ID 019571e8-7e92-7021-99b8-c9797790de8d
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 62, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 143, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:27:36,063 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 00:27:36,116 [INFO] Created sync history record with ID: 3ba6ebf9-7667-4d56-bac5-07c5a24e1823
2025-03-08 00:27:36,118 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893', 'workflow_run_id': '019571f8-58b2-7bf6-8fcd-6b99f32ceba6', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 71, in create_sync_history
    return CreateSyncHistoryOutput(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-03-08 00:27:37,158 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 00:27:37,168 [INFO] Created sync history record with ID: c3c17448-5fde-4387-87e8-aacbf9dbd6e7
2025-03-08 00:27:37,169 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893', 'workflow_run_id': '019571f8-58b2-7bf6-8fcd-6b99f32ceba6', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 71, in create_sync_history
    return CreateSyncHistoryOutput(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-03-08 00:27:39,232 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 00:27:39,252 [INFO] Created sync history record with ID: 98ac7b15-8a5b-40da-9b20-42e04de0361c
2025-03-08 00:27:39,252 [WARNING] Completing activity as failed ({'activity_id': '1', 'activity_type': 'create_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893', 'workflow_run_id': '019571f8-58b2-7bf6-8fcd-6b99f32ceba6', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 71, in create_sync_history
    return CreateSyncHistoryOutput(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-03-08 00:27:39,303 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893 and run ID 019571f8-58b2-7bf6-8fcd-6b99f32ceba6
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 63, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:27:39,496 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893 and run ID 019571f8-58b2-7bf6-8fcd-6b99f32ceba6
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 63, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:27:39,546 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893 and run ID 019571f8-58b2-7bf6-8fcd-6b99f32ceba6
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 63, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:27:49,572 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893 and run ID 019571f8-58b2-7bf6-8fcd-6b99f32ceba6
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 63, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:27:59,563 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893 and run ID 019571f8-58b2-7bf6-8fcd-6b99f32ceba6
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 63, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:28:14,899 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893 and run ID 019571f8-58b2-7bf6-8fcd-6b99f32ceba6
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 63, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:28:33,446 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893 and run ID 019571f8-58b2-7bf6-8fcd-6b99f32ceba6
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 63, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:28:59,784 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893 and run ID 019571f8-58b2-7bf6-8fcd-6b99f32ceba6
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 63, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:29:42,382 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-4bbad4f8-b7aa-41e4-bb54-04596691d893 and run ID 019571f8-58b2-7bf6-8fcd-6b99f32ceba6
temporalio.exceptions.ApplicationError: ValidationError: 1 validation error for CreateSyncHistoryOutput
sync_id
  Field required [type=missing, input_value={'sync_history_id': UUID(...: 'MANUAL_FILE_UPLOAD'>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 63, in run
    sync_history_result = await workflow.execute_activity(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:32:07,481 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 00:32:14,006 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 00:32:14,006 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 00:32:14,016 [INFO] Connected to Temporal server
2025-03-08 00:32:14,016 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 00:32:16,058 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 00:32:16,058 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 00:32:16,058 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 00:33:56,032 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 00:34:01,750 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 00:34:01,750 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 00:34:01,762 [INFO] Connected to Temporal server
2025-03-08 00:34:01,762 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 00:34:02,804 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 00:34:02,804 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 00:34:02,804 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 00:34:09,543 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 00:34:09,673 [INFO] Created sync history record with ID: c00407bf-5c2b-4534-bf7b-682549571907
2025-03-08 00:34:09,769 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 00:34:09,769 [INFO] Getting products from manual file upload
2025-03-08 00:34:09,787 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0', 'workflow_run_id': '019571fe-59cd-7aaa-a072-62a2b2302548', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 95, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 65, in process_products_from_data
    search_config = await get_search_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 36, in get_search_config
    search_config = await get_setting_by_key(SettingKey.SEARCH_CONFIG)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\utils\settings.py", line 39, in get_setting_by_key
    result = await new_session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-08 00:34:11,165 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 00:34:11,165 [INFO] Getting products from manual file upload
2025-03-08 00:34:11,173 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0', 'workflow_run_id': '019571fe-59cd-7aaa-a072-62a2b2302548', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 95, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 65, in process_products_from_data
    search_config = await get_search_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 36, in get_search_config
    search_config = await get_setting_by_key(SettingKey.SEARCH_CONFIG)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\utils\settings.py", line 39, in get_setting_by_key
    result = await new_session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-08 00:34:13,215 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 00:34:13,215 [INFO] Getting products from manual file upload
2025-03-08 00:34:13,215 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0', 'workflow_run_id': '019571fe-59cd-7aaa-a072-62a2b2302548', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 95, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 65, in process_products_from_data
    search_config = await get_search_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 36, in get_search_config
    search_config = await get_setting_by_key(SettingKey.SEARCH_CONFIG)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\utils\settings.py", line 39, in get_setting_by_key
    result = await new_session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-08 00:34:13,315 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('c00407bf-5c2b-4534-bf7b-682549571907'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:34:13,315 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0 and run ID 019571fe-59cd-7aaa-a072-62a2b2302548
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:34:13,390 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('c00407bf-5c2b-4534-bf7b-682549571907'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:34:13,390 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0 and run ID 019571fe-59cd-7aaa-a072-62a2b2302548
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:34:13,455 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('c00407bf-5c2b-4534-bf7b-682549571907'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:34:13,455 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0 and run ID 019571fe-59cd-7aaa-a072-62a2b2302548
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:34:23,463 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('c00407bf-5c2b-4534-bf7b-682549571907'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:34:23,463 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0 and run ID 019571fe-59cd-7aaa-a072-62a2b2302548
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:34:33,488 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('c00407bf-5c2b-4534-bf7b-682549571907'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:34:33,488 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0 and run ID 019571fe-59cd-7aaa-a072-62a2b2302548
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:34:48,352 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('c00407bf-5c2b-4534-bf7b-682549571907'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:34:48,352 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0 and run ID 019571fe-59cd-7aaa-a072-62a2b2302548
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:35:07,988 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('c00407bf-5c2b-4534-bf7b-682549571907'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:35:07,988 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0 and run ID 019571fe-59cd-7aaa-a072-62a2b2302548
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:35:34,013 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('c00407bf-5c2b-4534-bf7b-682549571907'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:35:34,013 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0 and run ID 019571fe-59cd-7aaa-a072-62a2b2302548
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:36:18,203 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('c00407bf-5c2b-4534-bf7b-682549571907'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:36:18,203 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-1a2126f2-5317-4bcb-9207-30fc898831e0 and run ID 019571fe-59cd-7aaa-a072-62a2b2302548
temporalio.exceptions.ApplicationError: UndefinedObjectError: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedObjectError'>: type "settingkey" does not exist
[SQL: SELECT settings.key, settings.title, settings.description, settings.value, settings.created_at, settings.updated_at 
FROM settings 
WHERE settings.key = $1::settingkey]
[parameters: ('SEARCH_CONFIG',)]
(Background on this error at: https://sqlalche.me/e/20/f405)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:41:38,188 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 00:41:46,348 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 00:41:46,348 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 00:41:46,374 [INFO] Connected to Temporal server
2025-03-08 00:41:46,374 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 00:41:48,128 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 00:41:48,128 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 00:41:48,128 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 00:43:20,234 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 00:43:20,370 [INFO] Created sync history record with ID: 4691d415-2ec5-486c-8781-23244ac79506
2025-03-08 00:43:20,474 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 00:43:20,474 [INFO] Getting products from manual file upload
2025-03-08 00:43:20,497 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8', 'workflow_run_id': '01957206-c0e0-7402-b7a2-cc28451d76cd', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 95, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 65, in process_products_from_data
    search_config = await get_search_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 38, in get_search_config
    raise ValueError("Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.")
ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.
2025-03-08 00:43:21,536 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 00:43:21,536 [INFO] Getting products from manual file upload
2025-03-08 00:43:21,543 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8', 'workflow_run_id': '01957206-c0e0-7402-b7a2-cc28451d76cd', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 95, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 65, in process_products_from_data
    search_config = await get_search_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 38, in get_search_config
    raise ValueError("Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.")
ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.
2025-03-08 00:43:23,599 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 00:43:23,600 [INFO] Getting products from manual file upload
2025-03-08 00:43:23,608 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8', 'workflow_run_id': '01957206-c0e0-7402-b7a2-cc28451d76cd', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 95, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 65, in process_products_from_data
    search_config = await get_search_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 38, in get_search_config
    raise ValueError("Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.")
ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.
2025-03-08 00:43:23,668 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('4691d415-2ec5-486c-8781-23244ac79506'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:43:23,668 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8 and run ID 01957206-c0e0-7402-b7a2-cc28451d76cd
temporalio.exceptions.ApplicationError: ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:43:23,753 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('4691d415-2ec5-486c-8781-23244ac79506'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:43:23,753 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8 and run ID 01957206-c0e0-7402-b7a2-cc28451d76cd
temporalio.exceptions.ApplicationError: ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:43:23,819 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('4691d415-2ec5-486c-8781-23244ac79506'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:43:23,819 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8 and run ID 01957206-c0e0-7402-b7a2-cc28451d76cd
temporalio.exceptions.ApplicationError: ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:43:33,836 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('4691d415-2ec5-486c-8781-23244ac79506'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:43:33,836 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8 and run ID 01957206-c0e0-7402-b7a2-cc28451d76cd
temporalio.exceptions.ApplicationError: ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:43:43,850 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('4691d415-2ec5-486c-8781-23244ac79506'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:43:43,850 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8 and run ID 01957206-c0e0-7402-b7a2-cc28451d76cd
temporalio.exceptions.ApplicationError: ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:43:58,831 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('4691d415-2ec5-486c-8781-23244ac79506'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:43:58,831 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8 and run ID 01957206-c0e0-7402-b7a2-cc28451d76cd
temporalio.exceptions.ApplicationError: ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:44:17,965 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('4691d415-2ec5-486c-8781-23244ac79506'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:44:17,965 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8 and run ID 01957206-c0e0-7402-b7a2-cc28451d76cd
temporalio.exceptions.ApplicationError: ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:44:44,115 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('4691d415-2ec5-486c-8781-23244ac79506'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:44:44,115 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8 and run ID 01957206-c0e0-7402-b7a2-cc28451d76cd
temporalio.exceptions.ApplicationError: ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:45:29,456 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('4691d415-2ec5-486c-8781-23244ac79506'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 00:45:29,457 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-09c739bf-a811-4400-a2c0-268440d166c8 and run ID 01957206-c0e0-7402-b7a2-cc28451d76cd
temporalio.exceptions.ApplicationError: ValueError: Search configuration must be set before syncing products. Please set SEARCH_CONFIG setting.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 00:50:58,940 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 00:51:05,379 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 00:51:05,379 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 00:51:05,408 [INFO] Connected to Temporal server
2025-03-08 00:51:05,408 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 00:51:07,485 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 00:51:07,485 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 00:51:07,485 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 01:53:40,291 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 01:53:49,453 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 01:53:49,453 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 01:53:49,498 [INFO] Connected to Temporal server
2025-03-08 01:53:49,499 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 01:53:51,743 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 01:53:51,744 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 01:53:51,744 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 01:55:05,718 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 01:55:05,952 [INFO] Created sync history record with ID: 2de1164c-5379-44ab-bb61-c70520f676d9
2025-03-08 01:55:06,098 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 01:55:06,098 [INFO] Getting products from manual file upload
2025-03-08 01:55:06,098 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d', 'workflow_run_id': '01957248-7283-7d13-a21d-b91d63a445b2', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 95, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 65, in process_products_from_data
    search_config = await get_search_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 36, in get_search_config
    search_config = await get_setting_by_key(SettingKey.SEARCH_CONFIG)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\utils\settings.py", line 37, in get_setting_by_key
    async with get_async_session() as new_session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-08 01:55:07,165 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 01:55:07,165 [INFO] Getting products from manual file upload
2025-03-08 01:55:07,165 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d', 'workflow_run_id': '01957248-7283-7d13-a21d-b91d63a445b2', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 95, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 65, in process_products_from_data
    search_config = await get_search_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 36, in get_search_config
    search_config = await get_setting_by_key(SettingKey.SEARCH_CONFIG)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\utils\settings.py", line 37, in get_setting_by_key
    async with get_async_session() as new_session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-08 01:55:09,240 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 01:55:09,240 [INFO] Getting products from manual file upload
2025-03-08 01:55:09,240 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d', 'workflow_run_id': '01957248-7283-7d13-a21d-b91d63a445b2', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 95, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 65, in process_products_from_data
    search_config = await get_search_config()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 36, in get_search_config
    search_config = await get_setting_by_key(SettingKey.SEARCH_CONFIG)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\utils\settings.py", line 37, in get_setting_by_key
    async with get_async_session() as new_session:
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-03-08 01:55:09,585 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2de1164c-5379-44ab-bb61-c70520f676d9'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 01:55:09,585 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d and run ID 01957248-7283-7d13-a21d-b91d63a445b2
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 01:55:09,671 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2de1164c-5379-44ab-bb61-c70520f676d9'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 01:55:09,671 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d and run ID 01957248-7283-7d13-a21d-b91d63a445b2
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 01:55:09,747 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2de1164c-5379-44ab-bb61-c70520f676d9'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 01:55:09,747 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d and run ID 01957248-7283-7d13-a21d-b91d63a445b2
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 01:55:19,764 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2de1164c-5379-44ab-bb61-c70520f676d9'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 01:55:19,764 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d and run ID 01957248-7283-7d13-a21d-b91d63a445b2
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 01:55:29,775 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2de1164c-5379-44ab-bb61-c70520f676d9'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 01:55:29,775 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d and run ID 01957248-7283-7d13-a21d-b91d63a445b2
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 01:55:43,974 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2de1164c-5379-44ab-bb61-c70520f676d9'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 01:55:43,974 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d and run ID 01957248-7283-7d13-a21d-b91d63a445b2
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 01:56:02,814 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2de1164c-5379-44ab-bb61-c70520f676d9'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 01:56:02,815 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d and run ID 01957248-7283-7d13-a21d-b91d63a445b2
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 01:56:30,010 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2de1164c-5379-44ab-bb61-c70520f676d9'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 01:56:30,010 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d and run ID 01957248-7283-7d13-a21d-b91d63a445b2
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 01:57:13,106 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2de1164c-5379-44ab-bb61-c70520f676d9'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 01:57:13,107 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-6a01f2a1-b30c-46f2-81f5-41345e765d3d and run ID 01957248-7283-7d13-a21d-b91d63a445b2
temporalio.exceptions.ApplicationError: TypeError: 'async_generator' object does not support the asynchronous context manager protocol

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:00:22,911 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 02:00:32,192 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:00:32,198 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:00:32,219 [INFO] Connected to Temporal server
2025-03-08 02:00:32,219 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 02:00:36,651 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 02:00:36,652 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 02:00:36,652 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 02:07:34,439 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 02:07:45,333 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:07:45,333 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:07:45,345 [INFO] Connected to Temporal server
2025-03-08 02:07:45,345 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 02:07:47,650 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 02:07:47,650 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 02:07:47,651 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 02:07:55,980 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 02:07:56,184 [INFO] Created sync history record with ID: 2cce24d3-4c87-40c4-9fef-4634786edf3f
2025-03-08 02:07:56,311 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 02:07:56,311 [INFO] Getting products from manual file upload
2025-03-08 02:07:57,399 [INFO] Total embedding process completed in 0.777s
2025-03-08 02:07:57,827 [INFO] Total embedding process completed in 0.428s
2025-03-08 02:07:58,208 [INFO] Total embedding process completed in 0.381s
2025-03-08 02:07:58,224 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 02:07:58,354 [INFO] Inserting 3 products into database
2025-03-08 02:07:58,546 [INFO] Inserted 3 products into database
2025-03-08 02:07:58,588 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:07:58,588 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9157eab9-5e8e-4efb-886b-e6163e509ef1 and run ID 01957254-3411-7f32-97e4-ea969aaa5e3d
Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 108, in run
    update_history_input = UpdateSyncHistoryInput(
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:07:58,762 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:07:58,762 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9157eab9-5e8e-4efb-886b-e6163e509ef1 and run ID 01957254-3411-7f32-97e4-ea969aaa5e3d
Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 108, in run
    update_history_input = UpdateSyncHistoryInput(
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:07:58,842 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:07:58,842 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9157eab9-5e8e-4efb-886b-e6163e509ef1 and run ID 01957254-3411-7f32-97e4-ea969aaa5e3d
Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 108, in run
    update_history_input = UpdateSyncHistoryInput(
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:08:08,859 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:08:08,859 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9157eab9-5e8e-4efb-886b-e6163e509ef1 and run ID 01957254-3411-7f32-97e4-ea969aaa5e3d
Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 108, in run
    update_history_input = UpdateSyncHistoryInput(
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:08:18,868 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:08:18,868 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9157eab9-5e8e-4efb-886b-e6163e509ef1 and run ID 01957254-3411-7f32-97e4-ea969aaa5e3d
Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 108, in run
    update_history_input = UpdateSyncHistoryInput(
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:08:33,872 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:08:33,872 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9157eab9-5e8e-4efb-886b-e6163e509ef1 and run ID 01957254-3411-7f32-97e4-ea969aaa5e3d
Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 108, in run
    update_history_input = UpdateSyncHistoryInput(
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:08:53,453 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:08:53,454 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9157eab9-5e8e-4efb-886b-e6163e509ef1 and run ID 01957254-3411-7f32-97e4-ea969aaa5e3d
Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 108, in run
    update_history_input = UpdateSyncHistoryInput(
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:09:16,316 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 02:09:16,333 [INFO] Created sync history record with ID: 586ba109-7200-48ab-aeee-e9bf9f9f0474
2025-03-08 02:09:16,483 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 02:09:16,483 [INFO] Getting products from manual file upload
2025-03-08 02:09:17,265 [INFO] Total embedding process completed in 0.766s
2025-03-08 02:09:18,134 [INFO] Total embedding process completed in 0.861s
2025-03-08 02:09:18,707 [INFO] Total embedding process completed in 0.571s
2025-03-08 02:09:18,707 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 02:09:18,963 [INFO] Inserting 3 products into database
2025-03-08 02:09:19,020 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6', 'workflow_run_id': '01957255-6dc6-7dc0-9444-383f26af3f78', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 138, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 02:09:20,169 [INFO] Inserting 3 products into database
2025-03-08 02:09:20,196 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6', 'workflow_run_id': '01957255-6dc6-7dc0-9444-383f26af3f78', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 138, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 02:09:20,643 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:09:20,643 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9157eab9-5e8e-4efb-886b-e6163e509ef1 and run ID 01957254-3411-7f32-97e4-ea969aaa5e3d
Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 108, in run
    update_history_input = UpdateSyncHistoryInput(
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('2cce24d3-4c87-40c4-9fef-4634786edf3f'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:09:22,295 [INFO] Inserting 3 products into database
2025-03-08 02:09:22,328 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6', 'workflow_run_id': '01957255-6dc6-7dc0-9444-383f26af3f78', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 138, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 02:09:22,451 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('586ba109-7200-48ab-aeee-e9bf9f9f0474'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:09:22,452 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6 and run ID 01957255-6dc6-7dc0-9444-383f26af3f78
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:09:22,615 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('586ba109-7200-48ab-aeee-e9bf9f9f0474'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:09:22,616 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6 and run ID 01957255-6dc6-7dc0-9444-383f26af3f78
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:09:22,737 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('586ba109-7200-48ab-aeee-e9bf9f9f0474'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:09:22,737 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6 and run ID 01957255-6dc6-7dc0-9444-383f26af3f78
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:09:32,726 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('586ba109-7200-48ab-aeee-e9bf9f9f0474'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:09:32,726 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6 and run ID 01957255-6dc6-7dc0-9444-383f26af3f78
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:09:42,753 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('586ba109-7200-48ab-aeee-e9bf9f9f0474'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:09:42,753 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6 and run ID 01957255-6dc6-7dc0-9444-383f26af3f78
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:09:57,417 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('586ba109-7200-48ab-aeee-e9bf9f9f0474'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:09:57,417 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6 and run ID 01957255-6dc6-7dc0-9444-383f26af3f78
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:10:16,116 [ERROR] Error updating sync history: 1 validation error for UpdateSyncHistoryInput
sync_id
  Input should be a valid string [type=string_type, input_value=UUID('586ba109-7200-48ab-aeee-e9bf9f9f0474'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-03-08 02:10:16,116 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-98641593-dc8b-40f1-bb7b-12875720a8c6 and run ID 01957255-6dc6-7dc0-9444-383f26af3f78
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-001) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-001', 'Ergonomic Office Chair', '[0.04475654289126396,-0.0440279059112072,-0.01755141094326973,0.013952192850410938,-0.012114021927118301,0.02099420875310898,0.007988564670085907,-0. ... (15959 characters truncated) ... 97,0.006457017734646797,-0.0156563613563776,0.017658468335866928,0.021125389263033867,-0.02242562547326088,-0.03373191878199577,0.009473302401602268]', None, 'Ergonomic Office Chair High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture chair, office, ergonomic, furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (96 characters truncated) ... "in_stock": true, "price": 299.99, "product_id": "prod-001", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-002', 'Mechanical Keyboard', '[-0.017113395035266876,-0.06094164773821831,-0.030839085578918457,0.033498551696538925,-0.043869730085134506,0.025230487808585167,-0.0240340605378150 ... (15947 characters truncated) ... .029868563637137413,0.024286584928631783,-0.0072875600308179855,0.005038965493440628,-0.004530581180006266,-0.016653243452310562,0.01861204393208027]', None, 'Mechanical Keyboard Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories keyboard, mechanical, rgb, gaming', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (91 characters truncated) ... pg", "in_stock": true, "price": 129.99, "product_id": "prod-002", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-003', 'Ultrawide Monitor', '[-0.01122522447258234,-0.03289931267499924,-0.023511704057455063,0.02585132233798504,-0.027778534218668938,0.00994214415550232,0.028226573020219803,- ... (15951 characters truncated) ... .040052544325590134,-0.012118583545088768,0.016195502132177353,-0.004915815778076649,-0.021138889715075493,0.012205192819237709,0.002991292392835021]', None, 'Ultrawide Monitor 34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors monitor, ultrawide, curved, gaming', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (105 characters truncated) ... pg", "in_stock": false, "price": 599.99, "product_id": "prod-003", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:10:34,074 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 02:10:45,205 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:10:45,205 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:10:45,235 [INFO] Connected to Temporal server
2025-03-08 02:10:45,236 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 02:10:49,711 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 02:10:49,713 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 02:10:49,713 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 02:10:49,847 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 02:10:50,053 [INFO] Created sync history record with ID: e5e9bbbf-f29d-467b-ae08-a026af2bba7e
2025-03-08 02:10:50,163 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 02:10:50,163 [INFO] Getting products from manual file upload
2025-03-08 02:10:51,375 [INFO] Total embedding process completed in 0.941s
2025-03-08 02:10:51,771 [INFO] Total embedding process completed in 0.396s
2025-03-08 02:10:52,297 [INFO] Total embedding process completed in 0.511s
2025-03-08 02:10:52,297 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 02:10:52,409 [INFO] Inserting 3 products into database
2025-03-08 02:10:52,519 [INFO] Inserted 3 products into database
2025-03-08 02:10:52,659 [INFO] Updating sync history record with ID: e5e9bbbf-f29d-467b-ae08-a026af2bba7e
2025-03-08 02:10:52,664 [WARNING] Completing activity as failed ({'activity_id': '4', 'activity_type': 'update_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271', 'workflow_run_id': '01957256-d698-711e-8b4e-2d6fb85c43d7', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 164, in update_sync_history
    sync_history_db = await session.get(SyncHistoryDB, UUID(input_data.sync_id))
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bdush\AppData\Local\Programs\Python\Python312\Lib\uuid.py", line 175, in __init__
    hex = hex.replace('urn:', '').replace('uuid:', '')
          ^^^^^^^^^^^
AttributeError: 'UUID' object has no attribute 'replace'
2025-03-08 02:10:53,731 [INFO] Updating sync history record with ID: e5e9bbbf-f29d-467b-ae08-a026af2bba7e
2025-03-08 02:10:53,731 [WARNING] Completing activity as failed ({'activity_id': '4', 'activity_type': 'update_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271', 'workflow_run_id': '01957256-d698-711e-8b4e-2d6fb85c43d7', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 164, in update_sync_history
    sync_history_db = await session.get(SyncHistoryDB, UUID(input_data.sync_id))
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bdush\AppData\Local\Programs\Python\Python312\Lib\uuid.py", line 175, in __init__
    hex = hex.replace('urn:', '').replace('uuid:', '')
          ^^^^^^^^^^^
AttributeError: 'UUID' object has no attribute 'replace'
2025-03-08 02:10:55,802 [INFO] Updating sync history record with ID: e5e9bbbf-f29d-467b-ae08-a026af2bba7e
2025-03-08 02:10:55,809 [WARNING] Completing activity as failed ({'activity_id': '4', 'activity_type': 'update_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271', 'workflow_run_id': '01957256-d698-711e-8b4e-2d6fb85c43d7', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 164, in update_sync_history
    sync_history_db = await session.get(SyncHistoryDB, UUID(input_data.sync_id))
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bdush\AppData\Local\Programs\Python\Python312\Lib\uuid.py", line 175, in __init__
    hex = hex.replace('urn:', '').replace('uuid:', '')
          ^^^^^^^^^^^
AttributeError: 'UUID' object has no attribute 'replace'
2025-03-08 02:10:55,983 [INFO] Updating sync history record with ID: e5e9bbbf-f29d-467b-ae08-a026af2bba7e
2025-03-08 02:10:55,994 [WARNING] Completing activity as failed ({'activity_id': '5', 'activity_type': 'update_sync_history', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271', 'workflow_run_id': '01957256-d698-711e-8b4e-2d6fb85c43d7', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 164, in update_sync_history
    sync_history_db = await session.get(SyncHistoryDB, UUID(input_data.sync_id))
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bdush\AppData\Local\Programs\Python\Python312\Lib\uuid.py", line 175, in __init__
    hex = hex.replace('urn:', '').replace('uuid:', '')
          ^^^^^^^^^^^
AttributeError: 'UUID' object has no attribute 'replace'
2025-03-08 02:10:57,054 [INFO] Updating sync history record with ID: e5e9bbbf-f29d-467b-ae08-a026af2bba7e
2025-03-08 02:10:57,063 [WARNING] Completing activity as failed ({'activity_id': '5', 'activity_type': 'update_sync_history', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271', 'workflow_run_id': '01957256-d698-711e-8b4e-2d6fb85c43d7', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 164, in update_sync_history
    sync_history_db = await session.get(SyncHistoryDB, UUID(input_data.sync_id))
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bdush\AppData\Local\Programs\Python\Python312\Lib\uuid.py", line 175, in __init__
    hex = hex.replace('urn:', '').replace('uuid:', '')
          ^^^^^^^^^^^
AttributeError: 'UUID' object has no attribute 'replace'
2025-03-08 02:10:59,118 [INFO] Updating sync history record with ID: e5e9bbbf-f29d-467b-ae08-a026af2bba7e
2025-03-08 02:10:59,123 [WARNING] Completing activity as failed ({'activity_id': '5', 'activity_type': 'update_sync_history', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271', 'workflow_run_id': '01957256-d698-711e-8b4e-2d6fb85c43d7', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 164, in update_sync_history
    sync_history_db = await session.get(SyncHistoryDB, UUID(input_data.sync_id))
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bdush\AppData\Local\Programs\Python\Python312\Lib\uuid.py", line 175, in __init__
    hex = hex.replace('urn:', '').replace('uuid:', '')
          ^^^^^^^^^^^
AttributeError: 'UUID' object has no attribute 'replace'
2025-03-08 02:10:59,205 [ERROR] Error updating sync history: Activity task failed
2025-03-08 02:10:59,205 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271 and run ID 01957256-d698-711e-8b4e-2d6fb85c43d7
temporalio.exceptions.ApplicationError: AttributeError: 'UUID' object has no attribute 'replace'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 113, in run
    await workflow.execute_activity(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:10:59,325 [ERROR] Error updating sync history: Activity task failed
2025-03-08 02:10:59,326 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271 and run ID 01957256-d698-711e-8b4e-2d6fb85c43d7
temporalio.exceptions.ApplicationError: AttributeError: 'UUID' object has no attribute 'replace'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 113, in run
    await workflow.execute_activity(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:10:59,391 [ERROR] Error updating sync history: Activity task failed
2025-03-08 02:10:59,391 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271 and run ID 01957256-d698-711e-8b4e-2d6fb85c43d7
temporalio.exceptions.ApplicationError: AttributeError: 'UUID' object has no attribute 'replace'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 113, in run
    await workflow.execute_activity(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:11:09,415 [ERROR] Error updating sync history: Activity task failed
2025-03-08 02:11:09,415 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271 and run ID 01957256-d698-711e-8b4e-2d6fb85c43d7
temporalio.exceptions.ApplicationError: AttributeError: 'UUID' object has no attribute 'replace'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 113, in run
    await workflow.execute_activity(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:11:19,441 [ERROR] Error updating sync history: Activity task failed
2025-03-08 02:11:19,441 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271 and run ID 01957256-d698-711e-8b4e-2d6fb85c43d7
temporalio.exceptions.ApplicationError: AttributeError: 'UUID' object has no attribute 'replace'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 113, in run
    await workflow.execute_activity(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:11:34,384 [ERROR] Error updating sync history: Activity task failed
2025-03-08 02:11:34,384 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271 and run ID 01957256-d698-711e-8b4e-2d6fb85c43d7
temporalio.exceptions.ApplicationError: AttributeError: 'UUID' object has no attribute 'replace'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 113, in run
    await workflow.execute_activity(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:11:53,593 [ERROR] Error updating sync history: Activity task failed
2025-03-08 02:11:53,593 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271 and run ID 01957256-d698-711e-8b4e-2d6fb85c43d7
temporalio.exceptions.ApplicationError: AttributeError: 'UUID' object has no attribute 'replace'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 113, in run
    await workflow.execute_activity(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:12:23,283 [ERROR] Error updating sync history: Activity task failed
2025-03-08 02:12:23,284 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271 and run ID 01957256-d698-711e-8b4e-2d6fb85c43d7
temporalio.exceptions.ApplicationError: AttributeError: 'UUID' object has no attribute 'replace'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 113, in run
    await workflow.execute_activity(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:13:07,864 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 02:13:16,850 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:13:16,851 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:13:16,867 [INFO] Connected to Temporal server
2025-03-08 02:13:16,867 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 02:13:18,689 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 02:13:18,690 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 02:13:18,690 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 02:13:18,775 [ERROR] Error updating sync history: Activity task failed
2025-03-08 02:13:18,775 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-971ec4e3-8f4c-4464-b218-8095bf2cc271 and run ID 01957256-d698-711e-8b4e-2d6fb85c43d7
temporalio.exceptions.ApplicationError: AttributeError: 'UUID' object has no attribute 'replace'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 113, in run
    await workflow.execute_activity(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 02:15:25,455 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 02:15:33,060 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:15:33,061 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 02:15:33,090 [INFO] Connected to Temporal server
2025-03-08 02:15:33,091 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 02:15:38,511 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 02:15:38,511 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 02:15:38,511 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 02:15:53,903 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 02:15:54,249 [INFO] Created sync history record with ID: 56a9823a-4074-40e1-8ee6-b9ad07e5e19c
2025-03-08 02:15:54,387 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 02:15:54,387 [INFO] Getting products from manual file upload
2025-03-08 02:15:55,906 [INFO] Total embedding process completed in 1.182s
2025-03-08 02:15:56,318 [INFO] Total embedding process completed in 0.412s
2025-03-08 02:15:56,798 [INFO] Total embedding process completed in 0.480s
2025-03-08 02:15:56,798 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 02:15:56,936 [INFO] Inserting 3 products into database
2025-03-08 02:15:57,035 [INFO] Inserted 3 products into database
2025-03-08 02:15:57,145 [INFO] Updating sync history record with ID: 56a9823a-4074-40e1-8ee6-b9ad07e5e19c
2025-03-08 02:15:57,209 [INFO] Updated sync history record with ID: 56a9823a-4074-40e1-8ee6-b9ad07e5e19c
2025-03-08 02:16:41,667 [ERROR] Worker failed, shutting down
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 162, in run
    task = await poll_task
           ^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\bridge\worker.py", line 156, in poll_activity_task
    await self._ref.poll_activity_task()
RuntimeError: Poll failure: Unhandled grpc error when polling: Status { code: InvalidArgument, message: "task queue name cannot start with reserved prefix /_sys/", metadata: MetadataMap { headers: {"content-type": "application/grpc"} }, source: None }

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 182, in run
    raise RuntimeError("Activity worker failed") from err
RuntimeError: Activity worker failed
2025-03-08 02:16:41,721 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-08 03:01:30,500 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 03:01:30,500 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-08 03:01:30,521 [INFO] Connected to Temporal server
2025-03-08 03:01:30,534 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-08 03:01:35,336 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-08 03:01:35,336 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-08 03:01:35,336 [INFO] Started worker with task queue product-sync-task-queue
2025-03-08 03:57:23,422 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 03:57:24,427 [INFO] Created sync history record with ID: bbad4988-a84c-4b63-8c80-9a8f8cb26135
2025-03-08 03:57:24,607 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 03:57:24,607 [INFO] Getting products from manual file upload
2025-03-08 03:57:28,433 [INFO] Total embedding process completed in 1.144s
2025-03-08 03:57:28,828 [INFO] Total embedding process completed in 0.393s
2025-03-08 03:57:29,344 [INFO] Total embedding process completed in 0.513s
2025-03-08 03:57:29,346 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 03:57:29,553 [INFO] Inserting 3 products into database
2025-03-08 03:57:30,042 [INFO] Inserted 3 products into database
2025-03-08 03:57:30,187 [INFO] Updating sync history record with ID: bbad4988-a84c-4b63-8c80-9a8f8cb26135
2025-03-08 03:57:30,231 [INFO] Updated sync history record with ID: bbad4988-a84c-4b63-8c80-9a8f8cb26135
2025-03-08 03:59:41,954 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 03:59:41,971 [INFO] Created sync history record with ID: b8c368fe-3f27-4895-ac1c-6fe2a8e646b3
2025-03-08 03:59:42,134 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 03:59:42,134 [INFO] Getting products from manual file upload
2025-03-08 03:59:42,568 [INFO] Total embedding process completed in 0.424s
2025-03-08 03:59:43,080 [INFO] Total embedding process completed in 0.511s
2025-03-08 03:59:43,590 [INFO] Total embedding process completed in 0.510s
2025-03-08 03:59:43,590 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 03:59:43,697 [INFO] Inserting 3 products into database
2025-03-08 03:59:43,741 [INFO] Inserted 3 products into database
2025-03-08 03:59:43,851 [INFO] Updating sync history record with ID: b8c368fe-3f27-4895-ac1c-6fe2a8e646b3
2025-03-08 03:59:43,872 [INFO] Updated sync history record with ID: b8c368fe-3f27-4895-ac1c-6fe2a8e646b3
2025-03-08 04:03:28,986 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:03:29,001 [INFO] Created sync history record with ID: e74865c3-fb58-4de5-b28e-c543c3aeb017
2025-03-08 04:03:29,175 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:03:29,175 [INFO] Getting products from manual file upload
2025-03-08 04:03:29,783 [INFO] Total embedding process completed in 0.591s
2025-03-08 04:03:30,399 [INFO] Total embedding process completed in 0.616s
2025-03-08 04:03:31,002 [INFO] Total embedding process completed in 0.603s
2025-03-08 04:03:31,002 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:03:31,148 [INFO] Inserting 3 products into database
2025-03-08 04:03:31,199 [INFO] Inserted 3 products into database
2025-03-08 04:03:31,381 [INFO] Updating sync history record with ID: e74865c3-fb58-4de5-b28e-c543c3aeb017
2025-03-08 04:03:31,397 [INFO] Updated sync history record with ID: e74865c3-fb58-4de5-b28e-c543c3aeb017
2025-03-08 04:05:34,864 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:05:34,881 [INFO] Created sync history record with ID: f5de7d70-3950-45c6-8e1d-b57a5e47ebc6
2025-03-08 04:05:35,109 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:05:35,111 [INFO] Getting products from manual file upload
2025-03-08 04:05:35,600 [INFO] Total embedding process completed in 0.463s
2025-03-08 04:05:36,028 [INFO] Total embedding process completed in 0.427s
2025-03-08 04:05:36,455 [INFO] Total embedding process completed in 0.425s
2025-03-08 04:05:36,457 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:05:36,693 [INFO] Inserting 3 products into database
2025-03-08 04:05:36,759 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be', 'workflow_run_id': '019572bf-e985-7838-ad76-a16091fe1049', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:05:38,597 [INFO] Inserting 3 products into database
2025-03-08 04:05:38,642 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be', 'workflow_run_id': '019572bf-e985-7838-ad76-a16091fe1049', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:05:40,714 [INFO] Inserting 3 products into database
2025-03-08 04:05:40,761 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be', 'workflow_run_id': '019572bf-e985-7838-ad76-a16091fe1049', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:05:40,926 [INFO] Updating sync history record with ID: f5de7d70-3950-45c6-8e1d-b57a5e47ebc6
2025-03-08 04:05:40,997 [INFO] Updated sync history record with ID: f5de7d70-3950-45c6-8e1d-b57a5e47ebc6
2025-03-08 04:05:41,088 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be and run ID 019572bf-e985-7838-ad76-a16091fe1049
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:05:41,465 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be and run ID 019572bf-e985-7838-ad76-a16091fe1049
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:05:41,708 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be and run ID 019572bf-e985-7838-ad76-a16091fe1049
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:05:51,611 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be and run ID 019572bf-e985-7838-ad76-a16091fe1049
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:06:01,688 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be and run ID 019572bf-e985-7838-ad76-a16091fe1049
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:06:15,802 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be and run ID 019572bf-e985-7838-ad76-a16091fe1049
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:06:34,653 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be and run ID 019572bf-e985-7838-ad76-a16091fe1049
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:07:03,208 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be and run ID 019572bf-e985-7838-ad76-a16091fe1049
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:07:46,081 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-808d5618-985f-465d-a370-0922e8eb78be and run ID 019572bf-e985-7838-ad76-a16091fe1049
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:09:33,248 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:09:33,263 [INFO] Created sync history record with ID: dba97c8c-33ad-4b81-8e1f-6e421f6267a5
2025-03-08 04:09:33,443 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:09:33,443 [INFO] Getting products from manual file upload
2025-03-08 04:09:34,117 [INFO] Total embedding process completed in 0.662s
2025-03-08 04:09:34,733 [INFO] Total embedding process completed in 0.615s
2025-03-08 04:09:35,150 [INFO] Total embedding process completed in 0.416s
2025-03-08 04:09:35,151 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:09:35,264 [INFO] Inserting 3 products into database
2025-03-08 04:09:35,276 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8', 'workflow_run_id': '019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:09:36,342 [INFO] Inserting 3 products into database
2025-03-08 04:09:36,358 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8', 'workflow_run_id': '019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:09:38,428 [INFO] Inserting 3 products into database
2025-03-08 04:09:38,444 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8', 'workflow_run_id': '019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:09:38,612 [INFO] Updating sync history record with ID: dba97c8c-33ad-4b81-8e1f-6e421f6267a5
2025-03-08 04:09:38,658 [INFO] Updated sync history record with ID: dba97c8c-33ad-4b81-8e1f-6e421f6267a5
2025-03-08 04:09:38,738 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8 and run ID 019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:09:38,929 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8 and run ID 019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:09:39,142 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8 and run ID 019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:09:49,089 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8 and run ID 019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:09:59,109 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8 and run ID 019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:01,095 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:01,120 [INFO] Created sync history record with ID: 7732a664-d724-477c-9143-a7048b598cb2
2025-03-08 04:10:01,271 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:01,272 [INFO] Getting products from manual file upload
2025-03-08 04:10:01,864 [INFO] Total embedding process completed in 0.580s
2025-03-08 04:10:02,583 [INFO] Total embedding process completed in 0.719s
2025-03-08 04:10:03,015 [INFO] Total embedding process completed in 0.432s
2025-03-08 04:10:03,015 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:03,178 [INFO] Inserting 3 products into database
2025-03-08 04:10:03,201 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15', 'workflow_run_id': '019572c3-f984-7db5-8525-7685d3d759b5', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:10:04,249 [INFO] Inserting 3 products into database
2025-03-08 04:10:04,275 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15', 'workflow_run_id': '019572c3-f984-7db5-8525-7685d3d759b5', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:10:06,315 [INFO] Inserting 3 products into database
2025-03-08 04:10:06,346 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15', 'workflow_run_id': '019572c3-f984-7db5-8525-7685d3d759b5', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:10:06,509 [INFO] Updating sync history record with ID: 7732a664-d724-477c-9143-a7048b598cb2
2025-03-08 04:10:06,521 [INFO] Updated sync history record with ID: 7732a664-d724-477c-9143-a7048b598cb2
2025-03-08 04:10:06,610 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15 and run ID 019572c3-f984-7db5-8525-7685d3d759b5
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:06,714 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15 and run ID 019572c3-f984-7db5-8525-7685d3d759b5
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:06,826 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15 and run ID 019572c3-f984-7db5-8525-7685d3d759b5
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:13,828 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8 and run ID 019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:16,847 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15 and run ID 019572c3-f984-7db5-8525-7685d3d759b5
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:23,225 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:23,245 [INFO] Created sync history record with ID: 022ebe19-2b0f-4e88-930b-9a328804ee57
2025-03-08 04:10:23,431 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:23,431 [INFO] Getting products from manual file upload
2025-03-08 04:10:23,960 [INFO] Total embedding process completed in 0.513s
2025-03-08 04:10:24,185 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:24.088319+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:24,540 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c', 'workflow_run_id': '019572c4-5010-7746-948d-da518ebd5b8e', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:24.088319+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:25,615 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:25,615 [INFO] Getting products from manual file upload
2025-03-08 04:10:25,779 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:25.7462177+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:25,779 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c', 'workflow_run_id': '019572c4-5010-7746-948d-da518ebd5b8e', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:25.7462177+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:26,861 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15 and run ID 019572c3-f984-7db5-8525-7685d3d759b5
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:27,832 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:27,845 [INFO] Getting products from manual file upload
2025-03-08 04:10:28,217 [INFO] Total embedding process completed in 0.357s
2025-03-08 04:10:28,779 [INFO] Total embedding process completed in 0.561s
2025-03-08 04:10:28,912 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:28,912 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c', 'workflow_run_id': '019572c4-5010-7746-948d-da518ebd5b8e', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:29,107 [INFO] Updating sync history record with ID: 022ebe19-2b0f-4e88-930b-9a328804ee57
2025-03-08 04:10:29,243 [INFO] Updated sync history record with ID: 022ebe19-2b0f-4e88-930b-9a328804ee57
2025-03-08 04:10:29,283 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c and run ID 019572c4-5010-7746-948d-da518ebd5b8e
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:29,493 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c and run ID 019572c4-5010-7746-948d-da518ebd5b8e
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:29,606 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c and run ID 019572c4-5010-7746-948d-da518ebd5b8e
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:33,798 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8 and run ID 019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:38,626 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:38,639 [INFO] Created sync history record with ID: 45f9568c-261d-42f0-8ca3-793d160ca71c
2025-03-08 04:10:38,814 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:38,814 [INFO] Getting products from manual file upload
2025-03-08 04:10:39,549 [INFO] Total embedding process completed in 0.718s
2025-03-08 04:10:39,592 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c and run ID 019572c4-5010-7746-948d-da518ebd5b8e
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:39,954 [INFO] Total embedding process completed in 0.405s
2025-03-08 04:10:40,059 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:40.0357265+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:40,059 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527', 'workflow_run_id': '019572c4-8c37-7515-9be3-c5fbb9c91fb1', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:40.0357265+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:41,106 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15 and run ID 019572c3-f984-7db5-8525-7685d3d759b5
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:41,113 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:41,113 [INFO] Getting products from manual file upload
2025-03-08 04:10:41,593 [INFO] Total embedding process completed in 0.480s
2025-03-08 04:10:42,213 [INFO] Total embedding process completed in 0.620s
2025-03-08 04:10:42,563 [INFO] Total embedding process completed in 0.346s
2025-03-08 04:10:42,563 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:42,774 [INFO] Inserting 3 products into database
2025-03-08 04:10:42,788 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527', 'workflow_run_id': '019572c4-8c37-7515-9be3-c5fbb9c91fb1', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:10:43,843 [INFO] Inserting 3 products into database
2025-03-08 04:10:43,874 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527', 'workflow_run_id': '019572c4-8c37-7515-9be3-c5fbb9c91fb1', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:10:45,266 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:45,291 [INFO] Created sync history record with ID: 5753133e-6ca8-4499-b3bf-0fa6acb1edc0
2025-03-08 04:10:45,458 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:45,458 [INFO] Getting products from manual file upload
2025-03-08 04:10:45,829 [INFO] Total embedding process completed in 0.365s
2025-03-08 04:10:45,940 [INFO] Inserting 3 products into database
2025-03-08 04:10:45,958 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527', 'workflow_run_id': '019572c4-8c37-7515-9be3-c5fbb9c91fb1', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:10:46,140 [INFO] Updating sync history record with ID: 45f9568c-261d-42f0-8ca3-793d160ca71c
2025-03-08 04:10:46,162 [INFO] Updated sync history record with ID: 45f9568c-261d-42f0-8ca3-793d160ca71c
2025-03-08 04:10:46,229 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527 and run ID 019572c4-8c37-7515-9be3-c5fbb9c91fb1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:46,338 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527 and run ID 019572c4-8c37-7515-9be3-c5fbb9c91fb1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:46,418 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527 and run ID 019572c4-8c37-7515-9be3-c5fbb9c91fb1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:46,514 [INFO] Total embedding process completed in 0.684s
2025-03-08 04:10:46,607 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:46.5903537+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:46,610 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417', 'workflow_run_id': '019572c4-a613-7324-bd45-7a11b9482135', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:46.5903537+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:47,656 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:47,657 [INFO] Getting products from manual file upload
2025-03-08 04:10:47,751 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:47.7377962+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:47,757 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417', 'workflow_run_id': '019572c4-a613-7324-bd45-7a11b9482135', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:47.7377962+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:49,652 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c and run ID 019572c4-5010-7746-948d-da518ebd5b8e
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:49,792 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:49,792 [INFO] Getting products from manual file upload
2025-03-08 04:10:49,886 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:49,898 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417', 'workflow_run_id': '019572c4-a613-7324-bd45-7a11b9482135', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:50,048 [INFO] Updating sync history record with ID: 5753133e-6ca8-4499-b3bf-0fa6acb1edc0
2025-03-08 04:10:50,065 [INFO] Updated sync history record with ID: 5753133e-6ca8-4499-b3bf-0fa6acb1edc0
2025-03-08 04:10:50,139 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417 and run ID 019572c4-a613-7324-bd45-7a11b9482135
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:50,252 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417 and run ID 019572c4-a613-7324-bd45-7a11b9482135
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:50,358 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417 and run ID 019572c4-a613-7324-bd45-7a11b9482135
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:53,841 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:53,858 [INFO] Created sync history record with ID: 8f243a59-eeff-4adb-a74c-8a385d6d75f3
2025-03-08 04:10:54,031 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:54,031 [INFO] Getting products from manual file upload
2025-03-08 04:10:54,142 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:54.1245063+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:54,142 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43', 'workflow_run_id': '019572c4-c7ad-7116-8fc7-e5e11e4fa848', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:54.1245063+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:55,173 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:55,173 [INFO] Getting products from manual file upload
2025-03-08 04:10:55,377 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:55.3453052+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:55,381 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43', 'workflow_run_id': '019572c4-c7ad-7116-8fc7-e5e11e4fa848', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:55.3453052+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:56,453 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527 and run ID 019572c4-8c37-7515-9be3-c5fbb9c91fb1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:57,418 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:10:57,418 [INFO] Getting products from manual file upload
2025-03-08 04:10:57,684 [ERROR] Error generating text embedding: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:57,686 [WARNING] Completing activity as failed ({'activity_id': '2', 'activity_type': 'get_products_from_source', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43', 'workflow_run_id': '019572c4-c7ad-7116-8fc7-e5e11e4fa848', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 85, in __await__
    response = yield from self._call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_interceptor.py", line 472, in __await__
    response = yield from call.__await__()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\grpc\aio\_call.py", line 327, in __await__
    raise _create_rpc_error(
grpc.aio._call.AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 94, in get_products_from_source
    products = await get_products_from_manual_upload(sync_input)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 136, in get_products_from_manual_upload
    return await process_products_from_data(sync_input.products)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\utils.py", line 85, in process_products_from_data
    text_embedding = await get_embedding(searchable_content, TaskType.DOCUMENT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\services\embedding.py", line 58, in get_embedding
    embeddings = await model.get_embeddings_async(inputs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\vertexai\language_models\_language_models.py", line 2224, in get_embeddings_async
    prediction_response = await self._endpoint.predict_async(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform\models.py", line 2490, in predict_async
    prediction_response = await self._prediction_async_client.predict(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\cloud\aiplatform_v1\services\prediction_service\async_client.py", line 447, in predict
    response = await rpc(
               ^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\google\api_core\grpc_helpers_async.py", line 88, in __await__
    raise exceptions.from_grpc_error(rpc_error) from rpc_error
google.api_core.exceptions.ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.
2025-03-08 04:10:57,817 [INFO] Updating sync history record with ID: 8f243a59-eeff-4adb-a74c-8a385d6d75f3
2025-03-08 04:10:57,828 [INFO] Updated sync history record with ID: 8f243a59-eeff-4adb-a74c-8a385d6d75f3
2025-03-08 04:10:57,900 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43 and run ID 019572c4-c7ad-7116-8fc7-e5e11e4fa848
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:57,969 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43 and run ID 019572c4-c7ad-7116-8fc7-e5e11e4fa848
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:10:58,056 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43 and run ID 019572c4-c7ad-7116-8fc7-e5e11e4fa848
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:00,123 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15 and run ID 019572c3-f984-7db5-8525-7685d3d759b5
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:00,357 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417 and run ID 019572c4-a613-7324-bd45-7a11b9482135
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:02,461 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8 and run ID 019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:04,198 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c and run ID 019572c4-5010-7746-948d-da518ebd5b8e
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:06,471 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527 and run ID 019572c4-8c37-7515-9be3-c5fbb9c91fb1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:08,076 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43 and run ID 019572c4-c7ad-7116-8fc7-e5e11e4fa848
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:10,375 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417 and run ID 019572c4-a613-7324-bd45-7a11b9482135
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:18,103 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43 and run ID 019572c4-c7ad-7116-8fc7-e5e11e4fa848
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:21,175 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527 and run ID 019572c4-8c37-7515-9be3-c5fbb9c91fb1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:22,889 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c and run ID 019572c4-5010-7746-948d-da518ebd5b8e
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:24,904 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417 and run ID 019572c4-a613-7324-bd45-7a11b9482135
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:29,782 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15 and run ID 019572c3-f984-7db5-8525-7685d3d759b5
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:32,023 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:11:32,047 [INFO] Created sync history record with ID: f6c8c40a-5283-4f40-849e-f8b0e39e60f4
2025-03-08 04:11:32,226 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:11:32,226 [INFO] Getting products from manual file upload
2025-03-08 04:11:32,623 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43 and run ID 019572c4-c7ad-7116-8fc7-e5e11e4fa848
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:32,681 [INFO] Total embedding process completed in 0.439s
2025-03-08 04:11:33,126 [INFO] Total embedding process completed in 0.445s
2025-03-08 04:11:33,718 [INFO] Total embedding process completed in 0.592s
2025-03-08 04:11:33,718 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:11:33,841 [INFO] Inserting 3 products into database
2025-03-08 04:11:33,872 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a', 'workflow_run_id': '019572c5-5cb9-7562-a6aa-1e1e8f2b5048', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:11:34,945 [INFO] Inserting 3 products into database
2025-03-08 04:11:35,006 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a', 'workflow_run_id': '019572c5-5cb9-7562-a6aa-1e1e8f2b5048', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:11:37,399 [INFO] Inserting 3 products into database
2025-03-08 04:11:37,419 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a', 'workflow_run_id': '019572c5-5cb9-7562-a6aa-1e1e8f2b5048', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:11:37,559 [INFO] Updating sync history record with ID: f6c8c40a-5283-4f40-849e-f8b0e39e60f4
2025-03-08 04:11:37,578 [INFO] Updated sync history record with ID: f6c8c40a-5283-4f40-849e-f8b0e39e60f4
2025-03-08 04:11:37,631 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a and run ID 019572c5-5cb9-7562-a6aa-1e1e8f2b5048
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:37,764 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a and run ID 019572c5-5cb9-7562-a6aa-1e1e8f2b5048
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:37,873 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a and run ID 019572c5-5cb9-7562-a6aa-1e1e8f2b5048
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:40,578 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527 and run ID 019572c4-8c37-7515-9be3-c5fbb9c91fb1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:43,420 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417 and run ID 019572c4-a613-7324-bd45-7a11b9482135
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:47,863 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a and run ID 019572c5-5cb9-7562-a6aa-1e1e8f2b5048
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:48,743 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-62a90574-e7d2-4ffb-900c-8b65b6b0ddf8 and run ID 019572c3-8cd3-7f2b-b6d3-ccbe8cdbc6e0
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:50,349 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c and run ID 019572c4-5010-7746-948d-da518ebd5b8e
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:51,825 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43 and run ID 019572c4-c7ad-7116-8fc7-e5e11e4fa848
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:11:57,896 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a and run ID 019572c5-5cb9-7562-a6aa-1e1e8f2b5048
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:07,135 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527 and run ID 019572c4-8c37-7515-9be3-c5fbb9c91fb1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:11,140 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417 and run ID 019572c4-a613-7324-bd45-7a11b9482135
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:12,044 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a and run ID 019572c5-5cb9-7562-a6aa-1e1e8f2b5048
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:13,289 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3374b48a-95f9-4a01-8154-dd3dd1a48c15 and run ID 019572c3-f984-7db5-8525-7685d3d759b5
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:19,122 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43 and run ID 019572c4-c7ad-7116-8fc7-e5e11e4fa848
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:30,905 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a and run ID 019572c5-5cb9-7562-a6aa-1e1e8f2b5048
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:36,496 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b41f0f95-c4bc-4c4c-a87e-f440a3f7030c and run ID 019572c4-5010-7746-948d-da518ebd5b8e
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:28.882797+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:55,172 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e9ff032b-f3f9-4156-9448-9f86b7bf5527 and run ID 019572c4-8c37-7515-9be3-c5fbb9c91fb1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:57,926 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a854696d-7340-43c7-8586-da02bacba417 and run ID 019572c4-a613-7324-bd45-7a11b9482135
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.", grpc_status:8, created_time:"2025-03-07T22:40:49.8793603+00:00"}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:12:59,653 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a and run ID 019572c5-5cb9-7562-a6aa-1e1e8f2b5048
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:13:02,732 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-2f97a199-623a-4841-9403-30e2d2b46f43 and run ID 019572c4-c7ad-7116-8fc7-e5e11e4fa848
temporalio.exceptions.ApplicationError: AioRpcError: <AioRpcError of RPC that terminated with:
	status = StatusCode.RESOURCE_EXHAUSTED
	details = "Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2404:6800:4002:81c::200a%5D:443 {created_time:"2025-03-07T22:40:57.671251+00:00", grpc_status:8, grpc_message:"Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai."}"
>

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: ResourceExhausted: 429 Quota exceeded for aiplatform.googleapis.com/online_prediction_requests_per_base_model with base model: textembedding-gecko. Please submit a quota increase request. https://cloud.google.com/vertex-ai/docs/generative-ai/quotas-genai.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 73, in run
    products_output = await workflow.execute_activity(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:13:43,621 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-3ab5df30-6c49-4c2e-8872-688b62196b4a and run ID 019572c5-5cb9-7562-a6aa-1e1e8f2b5048
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:15:08,907 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:15:08,926 [INFO] Created sync history record with ID: 8b911d2f-7a3b-4bc6-a39a-42915416aab1
2025-03-08 04:15:09,120 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:15:09,121 [INFO] Getting products from manual file upload
2025-03-08 04:15:09,779 [INFO] Total embedding process completed in 0.647s
2025-03-08 04:15:10,391 [INFO] Total embedding process completed in 0.612s
2025-03-08 04:15:11,004 [INFO] Total embedding process completed in 0.613s
2025-03-08 04:15:11,004 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:15:11,109 [INFO] Inserting 3 products into database
2025-03-08 04:15:11,127 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1', 'workflow_run_id': '019572c8-ac08-7e10-a044-6b5af04473b9', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:15:12,180 [INFO] Inserting 3 products into database
2025-03-08 04:15:12,194 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1', 'workflow_run_id': '019572c8-ac08-7e10-a044-6b5af04473b9', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:15:14,242 [INFO] Inserting 3 products into database
2025-03-08 04:15:14,267 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1', 'workflow_run_id': '019572c8-ac08-7e10-a044-6b5af04473b9', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:15:14,436 [INFO] Updating sync history record with ID: 8b911d2f-7a3b-4bc6-a39a-42915416aab1
2025-03-08 04:15:14,453 [INFO] Updated sync history record with ID: 8b911d2f-7a3b-4bc6-a39a-42915416aab1
2025-03-08 04:15:14,537 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1 and run ID 019572c8-ac08-7e10-a044-6b5af04473b9
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:15:14,697 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1 and run ID 019572c8-ac08-7e10-a044-6b5af04473b9
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:15:14,801 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1 and run ID 019572c8-ac08-7e10-a044-6b5af04473b9
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:15:24,812 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1 and run ID 019572c8-ac08-7e10-a044-6b5af04473b9
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:15:34,824 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1 and run ID 019572c8-ac08-7e10-a044-6b5af04473b9
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:15:49,515 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1 and run ID 019572c8-ac08-7e10-a044-6b5af04473b9
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:00,477 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:16:00,490 [INFO] Created sync history record with ID: a611c978-5e60-4fa0-accd-68bfa7e57407
2025-03-08 04:16:00,678 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:16:00,678 [INFO] Getting products from manual file upload
2025-03-08 04:16:01,490 [INFO] Total embedding process completed in 0.803s
2025-03-08 04:16:02,105 [INFO] Total embedding process completed in 0.613s
2025-03-08 04:16:02,577 [INFO] Total embedding process completed in 0.471s
2025-03-08 04:16:02,582 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:16:02,726 [INFO] Inserting 3 products into database
2025-03-08 04:16:02,752 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c', 'workflow_run_id': '019572c9-7584-73ab-bae5-780c688b8f9d', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:16:03,815 [INFO] Inserting 3 products into database
2025-03-08 04:16:03,839 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c', 'workflow_run_id': '019572c9-7584-73ab-bae5-780c688b8f9d', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:16:05,889 [INFO] Inserting 3 products into database
2025-03-08 04:16:05,916 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c', 'workflow_run_id': '019572c9-7584-73ab-bae5-780c688b8f9d', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:16:06,077 [INFO] Updating sync history record with ID: a611c978-5e60-4fa0-accd-68bfa7e57407
2025-03-08 04:16:06,096 [INFO] Updated sync history record with ID: a611c978-5e60-4fa0-accd-68bfa7e57407
2025-03-08 04:16:06,168 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c and run ID 019572c9-7584-73ab-bae5-780c688b8f9d
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:06,291 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c and run ID 019572c9-7584-73ab-bae5-780c688b8f9d
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:06,385 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c and run ID 019572c9-7584-73ab-bae5-780c688b8f9d
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:08,843 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:16:08,859 [INFO] Created sync history record with ID: 00131eb6-54e9-467e-8f16-1048c15ebd7b
2025-03-08 04:16:09,038 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:16:09,038 [INFO] Getting products from manual file upload
2025-03-08 04:16:09,157 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1 and run ID 019572c8-ac08-7e10-a044-6b5af04473b9
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:09,685 [INFO] Total embedding process completed in 0.625s
2025-03-08 04:16:10,195 [INFO] Total embedding process completed in 0.509s
2025-03-08 04:16:10,608 [INFO] Total embedding process completed in 0.412s
2025-03-08 04:16:10,608 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:16:10,760 [INFO] Inserting 3 products into database
2025-03-08 04:16:10,778 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9', 'workflow_run_id': '019572c9-9614-7811-bb3d-5d9cab86b77b', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:16:11,844 [INFO] Inserting 3 products into database
2025-03-08 04:16:11,849 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9', 'workflow_run_id': '019572c9-9614-7811-bb3d-5d9cab86b77b', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:16:13,919 [INFO] Inserting 3 products into database
2025-03-08 04:16:13,942 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9', 'workflow_run_id': '019572c9-9614-7811-bb3d-5d9cab86b77b', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:16:14,075 [INFO] Updating sync history record with ID: 00131eb6-54e9-467e-8f16-1048c15ebd7b
2025-03-08 04:16:14,092 [INFO] Updated sync history record with ID: 00131eb6-54e9-467e-8f16-1048c15ebd7b
2025-03-08 04:16:14,165 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9 and run ID 019572c9-9614-7811-bb3d-5d9cab86b77b
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:14,278 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9 and run ID 019572c9-9614-7811-bb3d-5d9cab86b77b
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:14,373 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9 and run ID 019572c9-9614-7811-bb3d-5d9cab86b77b
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:16,410 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c and run ID 019572c9-7584-73ab-bae5-780c688b8f9d
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:24,386 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9 and run ID 019572c9-9614-7811-bb3d-5d9cab86b77b
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:26,448 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c and run ID 019572c9-7584-73ab-bae5-780c688b8f9d
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:34,404 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9 and run ID 019572c9-9614-7811-bb3d-5d9cab86b77b
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:36,829 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1 and run ID 019572c8-ac08-7e10-a044-6b5af04473b9
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:41,178 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c and run ID 019572c9-7584-73ab-bae5-780c688b8f9d
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:16:49,157 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9 and run ID 019572c9-9614-7811-bb3d-5d9cab86b77b
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:00,881 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c and run ID 019572c9-7584-73ab-bae5-780c688b8f9d
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:07,805 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9 and run ID 019572c9-9614-7811-bb3d-5d9cab86b77b
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:23,384 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:17:23,408 [INFO] Created sync history record with ID: 78617c9f-b2e7-4734-8b5d-c9ba831d8f9d
2025-03-08 04:17:23,588 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:17:23,588 [INFO] Getting products from manual file upload
2025-03-08 04:17:23,796 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ee573da-d6ba-4823-8a7d-7c798c6ba7c1 and run ID 019572c8-ac08-7e10-a044-6b5af04473b9
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:24,033 [INFO] Total embedding process completed in 0.427s
2025-03-08 04:17:24,503 [INFO] Total embedding process completed in 0.470s
2025-03-08 04:17:24,858 [INFO] Total embedding process completed in 0.355s
2025-03-08 04:17:24,858 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:17:25,001 [INFO] Inserting 3 products into database
2025-03-08 04:17:25,016 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d', 'workflow_run_id': '019572ca-b94c-7cf2-9ad1-46fa1ebae842', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:17:26,086 [INFO] Inserting 3 products into database
2025-03-08 04:17:26,109 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d', 'workflow_run_id': '019572ca-b94c-7cf2-9ad1-46fa1ebae842', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:17:27,791 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c and run ID 019572c9-7584-73ab-bae5-780c688b8f9d
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:28,162 [INFO] Inserting 3 products into database
2025-03-08 04:17:28,186 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d', 'workflow_run_id': '019572ca-b94c-7cf2-9ad1-46fa1ebae842', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:17:28,357 [INFO] Updating sync history record with ID: 78617c9f-b2e7-4734-8b5d-c9ba831d8f9d
2025-03-08 04:17:28,370 [INFO] Updated sync history record with ID: 78617c9f-b2e7-4734-8b5d-c9ba831d8f9d
2025-03-08 04:17:28,451 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d and run ID 019572ca-b94c-7cf2-9ad1-46fa1ebae842
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:28,590 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d and run ID 019572ca-b94c-7cf2-9ad1-46fa1ebae842
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:28,701 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d and run ID 019572ca-b94c-7cf2-9ad1-46fa1ebae842
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:35,438 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9 and run ID 019572c9-9614-7811-bb3d-5d9cab86b77b
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:38,697 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d and run ID 019572ca-b94c-7cf2-9ad1-46fa1ebae842
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:17:48,698 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d and run ID 019572ca-b94c-7cf2-9ad1-46fa1ebae842
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:03,254 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d and run ID 019572ca-b94c-7cf2-9ad1-46fa1ebae842
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:09,604 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:18:09,625 [INFO] Created sync history record with ID: 61ac9ef1-0267-49da-a407-754cd554fd52
2025-03-08 04:18:09,787 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:18:09,787 [INFO] Getting products from manual file upload
2025-03-08 04:18:10,244 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-bafbd2b4-00cb-4dc1-a5dc-3c8c47c7dd7c and run ID 019572c9-7584-73ab-bae5-780c688b8f9d
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:10,513 [INFO] Total embedding process completed in 0.705s
2025-03-08 04:18:11,128 [INFO] Total embedding process completed in 0.614s
2025-03-08 04:18:11,740 [INFO] Total embedding process completed in 0.612s
2025-03-08 04:18:11,743 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:18:11,887 [INFO] Inserting 3 products into database
2025-03-08 04:18:11,894 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf', 'workflow_run_id': '019572cb-6de3-7bd7-ad4c-40784d35f990', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:18:12,968 [INFO] Inserting 3 products into database
2025-03-08 04:18:12,990 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf', 'workflow_run_id': '019572cb-6de3-7bd7-ad4c-40784d35f990', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:18:15,047 [INFO] Inserting 3 products into database
2025-03-08 04:18:15,068 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf', 'workflow_run_id': '019572cb-6de3-7bd7-ad4c-40784d35f990', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:18:15,237 [INFO] Updating sync history record with ID: 61ac9ef1-0267-49da-a407-754cd554fd52
2025-03-08 04:18:15,253 [INFO] Updated sync history record with ID: 61ac9ef1-0267-49da-a407-754cd554fd52
2025-03-08 04:18:15,317 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf and run ID 019572cb-6de3-7bd7-ad4c-40784d35f990
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:15,450 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf and run ID 019572cb-6de3-7bd7-ad4c-40784d35f990
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:15,551 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf and run ID 019572cb-6de3-7bd7-ad4c-40784d35f990
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:21,943 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d and run ID 019572ca-b94c-7cf2-9ad1-46fa1ebae842
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:22,560 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-9422a26a-1bcb-4f25-a8a3-be53024a40e9 and run ID 019572c9-9614-7811-bb3d-5d9cab86b77b
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:25,565 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf and run ID 019572cb-6de3-7bd7-ad4c-40784d35f990
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:35,577 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf and run ID 019572cb-6de3-7bd7-ad4c-40784d35f990
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:49,339 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d and run ID 019572ca-b94c-7cf2-9ad1-46fa1ebae842
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:18:50,294 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf and run ID 019572cb-6de3-7bd7-ad4c-40784d35f990
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:19:10,270 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf and run ID 019572cb-6de3-7bd7-ad4c-40784d35f990
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:19:32,367 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-7b0caea0-5dc2-4a0c-8ed4-ef718498345d and run ID 019572ca-b94c-7cf2-9ad1-46fa1ebae842
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:19:40,002 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf and run ID 019572cb-6de3-7bd7-ad4c-40784d35f990
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:20:23,448 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-25a2a6b6-0977-496b-9390-fe1837882dbf and run ID 019572cb-6de3-7bd7-ad4c-40784d35f990
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:21:35,541 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:21:35,558 [INFO] Created sync history record with ID: e1b27664-1012-4744-8f90-fb33dead62d9
2025-03-08 04:21:35,732 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:21:35,732 [INFO] Getting products from manual file upload
2025-03-08 04:21:36,152 [INFO] Total embedding process completed in 0.404s
2025-03-08 04:21:36,639 [INFO] Total embedding process completed in 0.487s
2025-03-08 04:21:37,247 [INFO] Total embedding process completed in 0.608s
2025-03-08 04:21:37,247 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:21:37,359 [INFO] Inserting 3 products into database
2025-03-08 04:21:37,374 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b', 'workflow_run_id': '019572ce-9260-73ab-bc6d-a353318e60a4', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:21:38,443 [INFO] Inserting 3 products into database
2025-03-08 04:21:38,471 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b', 'workflow_run_id': '019572ce-9260-73ab-bc6d-a353318e60a4', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:21:40,523 [INFO] Inserting 3 products into database
2025-03-08 04:21:40,538 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b', 'workflow_run_id': '019572ce-9260-73ab-bc6d-a353318e60a4', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:21:40,695 [INFO] Updating sync history record with ID: e1b27664-1012-4744-8f90-fb33dead62d9
2025-03-08 04:21:40,727 [INFO] Updated sync history record with ID: e1b27664-1012-4744-8f90-fb33dead62d9
2025-03-08 04:21:40,807 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b and run ID 019572ce-9260-73ab-bc6d-a353318e60a4
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:21:40,935 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b and run ID 019572ce-9260-73ab-bc6d-a353318e60a4
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:21:41,050 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b and run ID 019572ce-9260-73ab-bc6d-a353318e60a4
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:21:51,096 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b and run ID 019572ce-9260-73ab-bc6d-a353318e60a4
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:22:01,121 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b and run ID 019572ce-9260-73ab-bc6d-a353318e60a4
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:22:15,798 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b and run ID 019572ce-9260-73ab-bc6d-a353318e60a4
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:22:34,144 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b and run ID 019572ce-9260-73ab-bc6d-a353318e60a4
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:23:02,853 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b and run ID 019572ce-9260-73ab-bc6d-a353318e60a4
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:23:45,742 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-d7c8a092-858d-401c-b2a5-27fa90b6bd2b and run ID 019572ce-9260-73ab-bc6d-a353318e60a4
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:24:20,821 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:24:20,837 [INFO] Created sync history record with ID: d4b27fca-9ea2-40d3-9212-e0b3d7727bd4
2025-03-08 04:24:21,008 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:24:21,008 [INFO] Getting products from manual file upload
2025-03-08 04:24:21,505 [INFO] Total embedding process completed in 0.480s
2025-03-08 04:24:21,879 [INFO] Total embedding process completed in 0.374s
2025-03-08 04:24:22,262 [INFO] Total embedding process completed in 0.383s
2025-03-08 04:24:22,262 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:24:22,461 [INFO] Inserting 3 products into database
2025-03-08 04:24:22,502 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a', 'workflow_run_id': '019572d1-17db-75d3-8899-d74f7970e433', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:24:23,597 [INFO] Inserting 3 products into database
2025-03-08 04:24:23,639 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a', 'workflow_run_id': '019572d1-17db-75d3-8899-d74f7970e433', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:24:25,723 [INFO] Inserting 3 products into database
2025-03-08 04:24:25,761 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a', 'workflow_run_id': '019572d1-17db-75d3-8899-d74f7970e433', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:24:25,956 [INFO] Updating sync history record with ID: d4b27fca-9ea2-40d3-9212-e0b3d7727bd4
2025-03-08 04:24:25,988 [INFO] Updated sync history record with ID: d4b27fca-9ea2-40d3-9212-e0b3d7727bd4
2025-03-08 04:24:26,077 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a and run ID 019572d1-17db-75d3-8899-d74f7970e433
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:24:26,290 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a and run ID 019572d1-17db-75d3-8899-d74f7970e433
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:24:26,402 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a and run ID 019572d1-17db-75d3-8899-d74f7970e433
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:24:36,398 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a and run ID 019572d1-17db-75d3-8899-d74f7970e433
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:24:46,455 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a and run ID 019572d1-17db-75d3-8899-d74f7970e433
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:25:00,519 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a and run ID 019572d1-17db-75d3-8899-d74f7970e433
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:25:19,614 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a and run ID 019572d1-17db-75d3-8899-d74f7970e433
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:25:33,414 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:25:33,435 [INFO] Created sync history record with ID: 092ed344-3876-4d49-9fc8-41b8c732e287
2025-03-08 04:25:33,614 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:25:33,614 [INFO] Getting products from manual file upload
2025-03-08 04:25:34,202 [INFO] Total embedding process completed in 0.576s
2025-03-08 04:25:34,615 [INFO] Total embedding process completed in 0.413s
2025-03-08 04:25:35,328 [INFO] Total embedding process completed in 0.712s
2025-03-08 04:25:35,328 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:25:35,515 [INFO] Inserting 3 products into database
2025-03-08 04:25:35,531 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc', 'workflow_run_id': '019572d2-335a-7291-82e1-6fc1a1d5a1f8', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:25:36,595 [INFO] Inserting 3 products into database
2025-03-08 04:25:36,610 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc', 'workflow_run_id': '019572d2-335a-7291-82e1-6fc1a1d5a1f8', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:25:38,657 [INFO] Inserting 3 products into database
2025-03-08 04:25:38,679 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc', 'workflow_run_id': '019572d2-335a-7291-82e1-6fc1a1d5a1f8', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:25:38,825 [INFO] Updating sync history record with ID: 092ed344-3876-4d49-9fc8-41b8c732e287
2025-03-08 04:25:38,842 [INFO] Updated sync history record with ID: 092ed344-3876-4d49-9fc8-41b8c732e287
2025-03-08 04:25:38,924 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc and run ID 019572d2-335a-7291-82e1-6fc1a1d5a1f8
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:25:39,048 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc and run ID 019572d2-335a-7291-82e1-6fc1a1d5a1f8
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:25:39,135 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc and run ID 019572d2-335a-7291-82e1-6fc1a1d5a1f8
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:25:48,191 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a and run ID 019572d1-17db-75d3-8899-d74f7970e433
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:25:49,183 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc and run ID 019572d2-335a-7291-82e1-6fc1a1d5a1f8
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:25:59,183 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc and run ID 019572d2-335a-7291-82e1-6fc1a1d5a1f8
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:26:13,349 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc and run ID 019572d2-335a-7291-82e1-6fc1a1d5a1f8
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:26:31,580 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc and run ID 019572d2-335a-7291-82e1-6fc1a1d5a1f8
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:26:32,953 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-e4146cb9-e0b4-45f7-97a1-eeeac029444a and run ID 019572d1-17db-75d3-8899-d74f7970e433
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:26:58,049 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc and run ID 019572d2-335a-7291-82e1-6fc1a1d5a1f8
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:27:40,552 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-b3a91817-cfd2-487e-a684-890071b7acfc and run ID 019572d2-335a-7291-82e1-6fc1a1d5a1f8
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:31:15,307 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:31:15,322 [INFO] Created sync history record with ID: dc9374ec-1dff-4873-b3de-ada0b776c458
2025-03-08 04:31:15,485 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:31:15,485 [INFO] Getting products from manual file upload
2025-03-08 04:31:16,219 [INFO] Total embedding process completed in 0.720s
2025-03-08 04:31:16,729 [INFO] Total embedding process completed in 0.508s
2025-03-08 04:31:17,241 [INFO] Total embedding process completed in 0.513s
2025-03-08 04:31:17,244 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:31:17,369 [INFO] Inserting 3 products into database
2025-03-08 04:31:17,384 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79', 'workflow_run_id': '019572d7-6afe-7ace-969c-546895367816', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:31:18,448 [INFO] Inserting 3 products into database
2025-03-08 04:31:18,464 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79', 'workflow_run_id': '019572d7-6afe-7ace-969c-546895367816', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:31:20,526 [INFO] Inserting 3 products into database
2025-03-08 04:31:20,545 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79', 'workflow_run_id': '019572d7-6afe-7ace-969c-546895367816', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:31:20,725 [INFO] Updating sync history record with ID: dc9374ec-1dff-4873-b3de-ada0b776c458
2025-03-08 04:31:20,746 [INFO] Updated sync history record with ID: dc9374ec-1dff-4873-b3de-ada0b776c458
2025-03-08 04:31:20,836 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79 and run ID 019572d7-6afe-7ace-969c-546895367816
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:31:20,987 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79 and run ID 019572d7-6afe-7ace-969c-546895367816
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:31:21,062 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79 and run ID 019572d7-6afe-7ace-969c-546895367816
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:31:31,090 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79 and run ID 019572d7-6afe-7ace-969c-546895367816
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:31:41,095 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79 and run ID 019572d7-6afe-7ace-969c-546895367816
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:31:55,491 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79 and run ID 019572d7-6afe-7ace-969c-546895367816
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:32:13,573 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79 and run ID 019572d7-6afe-7ace-969c-546895367816
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:32:40,004 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79 and run ID 019572d7-6afe-7ace-969c-546895367816
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:33:24,135 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-a4205574-9ec3-4e70-9b24-b6143cbc9d79 and run ID 019572d7-6afe-7ace-969c-546895367816
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:00,021 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:36:00,051 [INFO] Created sync history record with ID: deee5b00-7d03-4621-9640-9086431f76bf
2025-03-08 04:36:00,188 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:36:00,201 [INFO] Getting products from manual file upload
2025-03-08 04:36:01,090 [INFO] Total embedding process completed in 0.872s
2025-03-08 04:36:01,499 [INFO] Total embedding process completed in 0.408s
2025-03-08 04:36:02,115 [INFO] Total embedding process completed in 0.615s
2025-03-08 04:36:02,122 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:36:02,313 [INFO] Inserting 3 products into database
2025-03-08 04:36:02,359 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce', 'workflow_run_id': '019572db-c329-7158-9d19-c41dc15cf9c1', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:36:03,427 [INFO] Inserting 3 products into database
2025-03-08 04:36:03,451 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce', 'workflow_run_id': '019572db-c329-7158-9d19-c41dc15cf9c1', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:36:05,517 [INFO] Inserting 3 products into database
2025-03-08 04:36:05,534 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce', 'workflow_run_id': '019572db-c329-7158-9d19-c41dc15cf9c1', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:36:05,662 [INFO] Updating sync history record with ID: deee5b00-7d03-4621-9640-9086431f76bf
2025-03-08 04:36:05,676 [INFO] Updated sync history record with ID: deee5b00-7d03-4621-9640-9086431f76bf
2025-03-08 04:36:05,755 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce and run ID 019572db-c329-7158-9d19-c41dc15cf9c1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:05,900 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce and run ID 019572db-c329-7158-9d19-c41dc15cf9c1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:05,993 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce and run ID 019572db-c329-7158-9d19-c41dc15cf9c1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:16,022 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce and run ID 019572db-c329-7158-9d19-c41dc15cf9c1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:21,230 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:36:21,246 [INFO] Created sync history record with ID: 2b17aff9-fc8c-4daf-8e7a-1706aee0dda7
2025-03-08 04:36:21,413 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:36:21,413 [INFO] Getting products from manual file upload
2025-03-08 04:36:21,978 [INFO] Total embedding process completed in 0.543s
2025-03-08 04:36:22,593 [INFO] Total embedding process completed in 0.615s
2025-03-08 04:36:23,200 [INFO] Total embedding process completed in 0.605s
2025-03-08 04:36:23,200 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:36:23,361 [INFO] Inserting 3 products into database
2025-03-08 04:36:23,391 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49', 'workflow_run_id': '019572dc-1627-71c5-9324-4ece49580d4e', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:36:24,449 [INFO] Inserting 3 products into database
2025-03-08 04:36:24,471 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49', 'workflow_run_id': '019572dc-1627-71c5-9324-4ece49580d4e', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:36:26,039 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce and run ID 019572db-c329-7158-9d19-c41dc15cf9c1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:26,529 [INFO] Inserting 3 products into database
2025-03-08 04:36:26,552 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49', 'workflow_run_id': '019572dc-1627-71c5-9324-4ece49580d4e', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:36:26,729 [INFO] Updating sync history record with ID: 2b17aff9-fc8c-4daf-8e7a-1706aee0dda7
2025-03-08 04:36:26,758 [INFO] Updated sync history record with ID: 2b17aff9-fc8c-4daf-8e7a-1706aee0dda7
2025-03-08 04:36:26,824 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49 and run ID 019572dc-1627-71c5-9324-4ece49580d4e
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:26,951 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49 and run ID 019572dc-1627-71c5-9324-4ece49580d4e
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:27,058 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49 and run ID 019572dc-1627-71c5-9324-4ece49580d4e
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:37,074 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49 and run ID 019572dc-1627-71c5-9324-4ece49580d4e
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:40,848 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce and run ID 019572db-c329-7158-9d19-c41dc15cf9c1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:36:47,083 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49 and run ID 019572dc-1627-71c5-9324-4ece49580d4e
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:00,333 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce and run ID 019572db-c329-7158-9d19-c41dc15cf9c1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:01,576 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49 and run ID 019572dc-1627-71c5-9324-4ece49580d4e
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:21,185 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49 and run ID 019572dc-1627-71c5-9324-4ece49580d4e
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:28,849 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce and run ID 019572db-c329-7158-9d19-c41dc15cf9c1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:31,300 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:37:31,327 [INFO] Created sync history record with ID: 92b39e4b-9e8e-467b-8987-d65c78589c27
2025-03-08 04:37:31,499 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:37:31,500 [INFO] Getting products from manual file upload
2025-03-08 04:37:32,121 [INFO] Total embedding process completed in 0.611s
2025-03-08 04:37:32,733 [INFO] Total embedding process completed in 0.612s
2025-03-08 04:37:33,347 [INFO] Total embedding process completed in 0.613s
2025-03-08 04:37:33,347 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:37:33,560 [INFO] Inserting 3 products into database
2025-03-08 04:37:33,607 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63', 'workflow_run_id': '019572dd-27b9-781a-b573-b0b50c64c939', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:37:34,674 [INFO] Inserting 3 products into database
2025-03-08 04:37:34,706 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63', 'workflow_run_id': '019572dd-27b9-781a-b573-b0b50c64c939', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:37:36,763 [INFO] Inserting 3 products into database
2025-03-08 04:37:36,790 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63', 'workflow_run_id': '019572dd-27b9-781a-b573-b0b50c64c939', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:37:36,954 [INFO] Updating sync history record with ID: 92b39e4b-9e8e-467b-8987-d65c78589c27
2025-03-08 04:37:36,986 [INFO] Updated sync history record with ID: 92b39e4b-9e8e-467b-8987-d65c78589c27
2025-03-08 04:37:37,067 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63 and run ID 019572dd-27b9-781a-b573-b0b50c64c939
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:37,209 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63 and run ID 019572dd-27b9-781a-b573-b0b50c64c939
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:37,320 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63 and run ID 019572dd-27b9-781a-b573-b0b50c64c939
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:47,337 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63 and run ID 019572dd-27b9-781a-b573-b0b50c64c939
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:50,140 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49 and run ID 019572dc-1627-71c5-9324-4ece49580d4e
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:37:57,373 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63 and run ID 019572dd-27b9-781a-b573-b0b50c64c939
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:38:11,783 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63 and run ID 019572dd-27b9-781a-b573-b0b50c64c939
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:38:13,791 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-0ca29096-ab80-4b7a-9fbc-f6a8cbb259ce and run ID 019572db-c329-7158-9d19-c41dc15cf9c1
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:38:31,173 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63 and run ID 019572dd-27b9-781a-b573-b0b50c64c939
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:38:37,871 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-11b2a325-01d8-4aa7-9b05-810fb6d09e49 and run ID 019572dc-1627-71c5-9324-4ece49580d4e
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:39:01,164 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63 and run ID 019572dd-27b9-781a-b573-b0b50c64c939
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:39:37,515 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-08 04:39:37,541 [INFO] Created sync history record with ID: 8ddc312a-2c40-4ea9-b0f2-f2f3910b67ad
2025-03-08 04:39:37,700 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:39:37,700 [INFO] Getting products from manual file upload
2025-03-08 04:39:38,375 [INFO] Total embedding process completed in 0.654s
2025-03-08 04:39:38,789 [INFO] Total embedding process completed in 0.414s
2025-03-08 04:39:39,195 [INFO] Total embedding process completed in 0.407s
2025-03-08 04:39:39,195 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-08 04:39:39,311 [INFO] Inserting 3 products into database
2025-03-08 04:39:39,328 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 1, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d', 'workflow_run_id': '019572df-14c8-7968-a121-e46c8ef7ab1a', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:39:40,383 [INFO] Inserting 3 products into database
2025-03-08 04:39:40,404 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 2, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d', 'workflow_run_id': '019572df-14c8-7968-a121-e46c8ef7ab1a', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:39:42,450 [INFO] Inserting 3 products into database
2025-03-08 04:39:42,482 [WARNING] Completing activity as failed ({'activity_id': '3', 'activity_type': 'insert_products', 'attempt': 3, 'namespace': 'default', 'task_queue': 'product-sync-task-queue', 'workflow_id': 'product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d', 'workflow_run_id': '019572df-14c8-7968-a121-e46c8ef7ab1a', 'workflow_type': 'ProductSyncWorkflow'})
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 453, in _run_activity
    result = await impl.execute_activity(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_activity.py", line 712, in execute_activity
    return await input.fn(*input.args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\activities.py", line 137, in insert_products
    await session.execute(stmt)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1294, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\engine\default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-08 04:39:42,625 [INFO] Updating sync history record with ID: 8ddc312a-2c40-4ea9-b0f2-f2f3910b67ad
2025-03-08 04:39:42,652 [INFO] Updated sync history record with ID: 8ddc312a-2c40-4ea9-b0f2-f2f3910b67ad
2025-03-08 04:39:42,734 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d and run ID 019572df-14c8-7968-a121-e46c8ef7ab1a
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:39:42,886 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d and run ID 019572df-14c8-7968-a121-e46c8ef7ab1a
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:39:43,004 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d and run ID 019572df-14c8-7968-a121-e46c8ef7ab1a
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:39:50,988 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-cfc24ecc-04b7-425b-bb5f-c8e86a442d63 and run ID 019572dd-27b9-781a-b573-b0b50c64c939
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:39:53,002 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d and run ID 019572df-14c8-7968-a121-e46c8ef7ab1a
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:40:03,031 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d and run ID 019572df-14c8-7968-a121-e46c8ef7ab1a
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:40:17,754 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d and run ID 019572df-14c8-7968-a121-e46c8ef7ab1a
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:40:35,963 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d and run ID 019572df-14c8-7968-a121-e46c8ef7ab1a
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:41:02,588 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d and run ID 019572df-14c8-7968-a121-e46c8ef7ab1a
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-08 04:41:49,034 [WARNING] Failed activation on workflow ProductSyncWorkflow with ID product-sync-manual_file_upload-fc9877a4-e0b4-449a-8070-3ca460e70c5d and run ID 019572df-14c8-7968-a121-e46c8ef7ab1a
temporalio.exceptions.ApplicationError: UniqueViolationError: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.

The above exception was the direct cause of the following exception:

temporalio.exceptions.ApplicationError: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "products_pkey"
DETAIL:  Key (id)=(prod-16) already exists.
[SQL: INSERT INTO products (id, title, text_embedding, image_embedding, searchable_content, custom_data) VALUES ($1::VARCHAR, $2::VARCHAR, $3, $4, $5::VARCHAR, $6::JSON), ($7::VARCHAR, $8::VARCHAR, $9, $10, $11::VARCHAR, $12::JSON), ($13::VARCHAR, $14::VARCHAR, $15, $16, $17::VARCHAR, $18::JSON)]
[parameters: ('prod-16', 'Ergonomic Office Chair', '[0.04438618943095207,-0.040327321738004684,-0.021488038823008537,-0.007400131784379482,-0.0005188507493585348,0.005744483321905136,0.0061778551898896 ... (15956 characters truncated) ... ,0.016987856477499008,-0.011341032572090626,0.02635430358350277,0.020419130101799965,-0.024095138534903526,-0.05457106977701187,0.026082631200551987]', None, 'High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back. Perfect for long work sessions. Office Furniture', '{"category": "Office Furniture", "description": "High-quality ergonomic office chair with adjustable height, lumbar support, and breathable mesh back ... (95 characters truncated) ...  "in_stock": true, "price": 299.99, "product_id": "prod-16", "product_name": "Ergonomic Office Chair", "tags": "chair, office, ergonomic, furniture"}', 'prod-17', 'Mechanical Keyboard', '[-0.01227464247494936,-0.048397962003946304,-0.033903587609529495,0.01975644938647747,-0.030875476077198982,0.018248243257403374,-0.00907669123262167 ... (15981 characters truncated) ... 93,0.03454918414354324,0.019184624776244164,-0.003821928985416889,0.017038440331816673,-0.00226342910900712,-0.027770565822720528,0.0313655287027359]', None, 'Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for both gaming and productivity. Computer Accessories', '{"category": "Computer Accessories", "description": "Mechanical keyboard with RGB lighting, programmable keys, and tactile switches. Designed for bot ... (90 characters truncated) ... jpg", "in_stock": true, "price": 129.99, "product_id": "prod-17", "product_name": "Mechanical Keyboard", "tags": "keyboard, mechanical, rgb, gaming"}', 'prod-18', 'Ultrawide Monitor', '[-0.0061411745846271515,-0.039944835007190704,-0.02815738320350647,0.010967717505991459,-0.022826524451375008,-0.0030945087783038616,0.02784910425543 ... (15955 characters truncated) ... ,0.045105572789907455,-0.0170181505382061,0.012271134182810783,0.005316982511430979,-0.03161008656024933,-0.0019942198414355516,0.019756745547056198]', None, '34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Ideal for multitasking and immersive gaming. Computer Monitors', '{"category": "Computer Monitors", "description": "34-inch curved ultrawide monitor with 3440x1440 resolution, 144Hz refresh rate, and HDR support. Id ... (104 characters truncated) ... jpg", "in_stock": false, "price": 599.99, "product_id": "prod-18", "product_name": "Ultrawide Monitor", "tags": "monitor, ultrawide, curved, gaming"}')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 100, in run
    records_processed = await workflow.execute_activity(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\workflow.py", line 2221, in execute_activity
    return await _Runtime.current().workflow_start_activity(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1522, in run_activity
    return await asyncio.shield(handle._result_fut)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
temporalio.exceptions.ActivityError: Activity task failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 391, in activate
    self._run_once(check_conditions=index == 1 or index == 2)
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1857, in _run_once
    raise self._current_activation_error
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 1875, in _run_top_level_workflow_function
    await coro
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 872, in run_workflow
    result = await self._inbound.execute_workflow(input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow_instance.py", line 2256, in execute_workflow
    return await input.run_fn(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 144, in run
    raise Exception(f"Error syncing products: {str(e)}")
Exception: Error syncing products: Activity task failed
2025-03-09 00:27:44,540 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-09 00:27:44,541 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-09 00:27:44,670 [INFO] Connected to Temporal server
2025-03-09 00:27:44,671 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-09 00:27:47,743 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-09 00:27:47,743 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-09 00:27:47,743 [INFO] Started worker with task queue product-sync-task-queue
2025-03-09 01:57:32,275 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-09 01:57:32,475 [INFO] Created sync history record with ID: e2d855a7-c03c-4de2-808b-78daee73ba05
2025-03-09 01:57:32,580 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-09 01:57:32,580 [INFO] Getting products from manual file upload
2025-03-09 01:57:34,245 [INFO] Total embedding process completed in 1.142s
2025-03-09 01:57:34,627 [INFO] Total embedding process completed in 0.381s
2025-03-09 01:57:35,024 [INFO] Total embedding process completed in 0.397s
2025-03-09 01:57:35,024 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-09 01:57:35,133 [INFO] Inserting 3 products into database
2025-03-09 01:57:35,252 [INFO] Inserted 3 products into database
2025-03-09 01:57:35,339 [INFO] Updating sync history record with ID: e2d855a7-c03c-4de2-808b-78daee73ba05
2025-03-09 01:57:35,357 [INFO] Updated sync history record with ID: e2d855a7-c03c-4de2-808b-78daee73ba05
2025-03-09 14:15:19,742 [INFO] Creating sync history record for source: MANUAL_FILE_UPLOAD
2025-03-09 14:15:19,760 [INFO] Created sync history record with ID: 9e257f73-fc1b-4435-bef0-6870413c82be
2025-03-09 14:15:19,958 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-09 14:15:19,958 [INFO] Getting products from manual file upload
2025-03-09 14:15:21,128 [INFO] Total embedding process completed in 1.156s
2025-03-09 14:15:21,523 [INFO] Total embedding process completed in 0.392s
2025-03-09 14:15:22,147 [INFO] Total embedding process completed in 0.624s
2025-03-09 14:15:22,630 [INFO] Total embedding process completed in 0.483s
2025-03-09 14:15:23,075 [INFO] Total embedding process completed in 0.445s
2025-03-09 14:15:23,580 [INFO] Total embedding process completed in 0.505s
2025-03-09 14:15:23,580 [INFO] Retrieved 6 products from source: MANUAL_FILE_UPLOAD
2025-03-09 14:15:23,738 [INFO] Inserting 6 products into database
2025-03-09 14:15:23,867 [INFO] Inserted 6 products into database
2025-03-09 14:15:24,012 [INFO] Updating sync history record with ID: 9e257f73-fc1b-4435-bef0-6870413c82be
2025-03-09 14:15:24,032 [INFO] Updated sync history record with ID: 9e257f73-fc1b-4435-bef0-6870413c82be
2025-03-09 16:20:23,921 [ERROR] Failed handling activation on workflow with run ID 01957a87-03fd-715d-8bcb-a1bc0cc1f25f
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 243, in _handle_activation
    workflow = self._create_workflow_instance(act, init_job)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 422, in _create_workflow_instance
    return self._workflow_runner.create_instance(det)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 94, in create_instance
    return _Instance(det, self._runner_class, self._restrictions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 122, in __init__
    self._create_instance()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 133, in _create_instance
    self._run_code(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 176, in _run_code
    exec(code, self.globals_and_locals, self.globals_and_locals)
  File "<string>", line 2, in <module>
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 442, in __call__
    return self.current(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 234, in _import
    mod = importlib.__import__(name, globals, locals, fromlist, level)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1466, in __import__
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 11, in <module>
    from app.models.sync_product import ProductSyncInput, ProductSyncWithIdInput
ImportError: cannot import name 'ProductSyncWithIdInput' from 'app.models.sync_product' (C:\startup\supersearch\app\models\sync_product.py)
2025-03-09 16:20:24,371 [ERROR] Failed handling activation on workflow with run ID 01957a87-03fd-715d-8bcb-a1bc0cc1f25f
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 243, in _handle_activation
    workflow = self._create_workflow_instance(act, init_job)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 422, in _create_workflow_instance
    return self._workflow_runner.create_instance(det)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 94, in create_instance
    return _Instance(det, self._runner_class, self._restrictions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 122, in __init__
    self._create_instance()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 133, in _create_instance
    self._run_code(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 176, in _run_code
    exec(code, self.globals_and_locals, self.globals_and_locals)
  File "<string>", line 2, in <module>
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 442, in __call__
    return self.current(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 234, in _import
    mod = importlib.__import__(name, globals, locals, fromlist, level)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1466, in __import__
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 11, in <module>
    from app.models.sync_product import ProductSyncInput, ProductSyncWithIdInput
ImportError: cannot import name 'ProductSyncWithIdInput' from 'app.models.sync_product' (C:\startup\supersearch\app\models\sync_product.py)
2025-03-09 16:20:34,393 [ERROR] Failed handling activation on workflow with run ID 01957a87-03fd-715d-8bcb-a1bc0cc1f25f
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 243, in _handle_activation
    workflow = self._create_workflow_instance(act, init_job)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 422, in _create_workflow_instance
    return self._workflow_runner.create_instance(det)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 94, in create_instance
    return _Instance(det, self._runner_class, self._restrictions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 122, in __init__
    self._create_instance()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 133, in _create_instance
    self._run_code(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 176, in _run_code
    exec(code, self.globals_and_locals, self.globals_and_locals)
  File "<string>", line 2, in <module>
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 442, in __call__
    return self.current(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 234, in _import
    mod = importlib.__import__(name, globals, locals, fromlist, level)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1466, in __import__
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 11, in <module>
    from app.models.sync_product import ProductSyncInput, ProductSyncWithIdInput
ImportError: cannot import name 'ProductSyncWithIdInput' from 'app.models.sync_product' (C:\startup\supersearch\app\models\sync_product.py)
2025-03-09 16:20:44,391 [ERROR] Failed handling activation on workflow with run ID 01957a87-03fd-715d-8bcb-a1bc0cc1f25f
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 243, in _handle_activation
    workflow = self._create_workflow_instance(act, init_job)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 422, in _create_workflow_instance
    return self._workflow_runner.create_instance(det)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 94, in create_instance
    return _Instance(det, self._runner_class, self._restrictions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 122, in __init__
    self._create_instance()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 133, in _create_instance
    self._run_code(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 176, in _run_code
    exec(code, self.globals_and_locals, self.globals_and_locals)
  File "<string>", line 2, in <module>
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 442, in __call__
    return self.current(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 234, in _import
    mod = importlib.__import__(name, globals, locals, fromlist, level)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1466, in __import__
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 11, in <module>
    from app.models.sync_product import ProductSyncInput, ProductSyncWithIdInput
ImportError: cannot import name 'ProductSyncWithIdInput' from 'app.models.sync_product' (C:\startup\supersearch\app\models\sync_product.py)
2025-03-09 16:20:58,842 [ERROR] Failed handling activation on workflow with run ID 01957a87-03fd-715d-8bcb-a1bc0cc1f25f
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 243, in _handle_activation
    workflow = self._create_workflow_instance(act, init_job)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 422, in _create_workflow_instance
    return self._workflow_runner.create_instance(det)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 94, in create_instance
    return _Instance(det, self._runner_class, self._restrictions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 122, in __init__
    self._create_instance()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 133, in _create_instance
    self._run_code(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 176, in _run_code
    exec(code, self.globals_and_locals, self.globals_and_locals)
  File "<string>", line 2, in <module>
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 442, in __call__
    return self.current(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 234, in _import
    mod = importlib.__import__(name, globals, locals, fromlist, level)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1466, in __import__
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 11, in <module>
    from app.models.sync_product import ProductSyncInput, ProductSyncWithIdInput
ImportError: cannot import name 'ProductSyncWithIdInput' from 'app.models.sync_product' (C:\startup\supersearch\app\models\sync_product.py)
2025-03-09 16:21:17,394 [ERROR] Failed handling activation on workflow with run ID 01957a87-03fd-715d-8bcb-a1bc0cc1f25f
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 243, in _handle_activation
    workflow = self._create_workflow_instance(act, init_job)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 422, in _create_workflow_instance
    return self._workflow_runner.create_instance(det)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 94, in create_instance
    return _Instance(det, self._runner_class, self._restrictions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 122, in __init__
    self._create_instance()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 133, in _create_instance
    self._run_code(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 176, in _run_code
    exec(code, self.globals_and_locals, self.globals_and_locals)
  File "<string>", line 2, in <module>
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 442, in __call__
    return self.current(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 234, in _import
    mod = importlib.__import__(name, globals, locals, fromlist, level)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1466, in __import__
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 11, in <module>
    from app.models.sync_product import ProductSyncInput, ProductSyncWithIdInput
ImportError: cannot import name 'ProductSyncWithIdInput' from 'app.models.sync_product' (C:\startup\supersearch\app\models\sync_product.py)
2025-03-09 16:21:45,699 [ERROR] Failed handling activation on workflow with run ID 01957a87-03fd-715d-8bcb-a1bc0cc1f25f
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 243, in _handle_activation
    workflow = self._create_workflow_instance(act, init_job)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 422, in _create_workflow_instance
    return self._workflow_runner.create_instance(det)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 94, in create_instance
    return _Instance(det, self._runner_class, self._restrictions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 122, in __init__
    self._create_instance()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 133, in _create_instance
    self._run_code(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 176, in _run_code
    exec(code, self.globals_and_locals, self.globals_and_locals)
  File "<string>", line 2, in <module>
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 442, in __call__
    return self.current(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 234, in _import
    mod = importlib.__import__(name, globals, locals, fromlist, level)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1466, in __import__
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 11, in <module>
    from app.models.sync_product import ProductSyncInput, ProductSyncWithIdInput
ImportError: cannot import name 'ProductSyncWithIdInput' from 'app.models.sync_product' (C:\startup\supersearch\app\models\sync_product.py)
2025-03-09 16:22:29,150 [ERROR] Failed handling activation on workflow with run ID 01957a87-03fd-715d-8bcb-a1bc0cc1f25f
Traceback (most recent call last):
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 243, in _handle_activation
    workflow = self._create_workflow_instance(act, init_job)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\_workflow.py", line 422, in _create_workflow_instance
    return self._workflow_runner.create_instance(det)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 94, in create_instance
    return _Instance(det, self._runner_class, self._restrictions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 122, in __init__
    self._create_instance()
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 133, in _create_instance
    self._run_code(
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_runner.py", line 176, in _run_code
    exec(code, self.globals_and_locals, self.globals_and_locals)
  File "<string>", line 2, in <module>
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 442, in __call__
    return self.current(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\startup\supersearch\supersearch_venv\Lib\site-packages\temporalio\worker\workflow_sandbox\_importer.py", line 234, in _import
    mod = importlib.__import__(name, globals, locals, fromlist, level)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1466, in __import__
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\startup\supersearch\app\temporal\workflows\product_sync\workflow.py", line 11, in <module>
    from app.models.sync_product import ProductSyncInput, ProductSyncWithIdInput
ImportError: cannot import name 'ProductSyncWithIdInput' from 'app.models.sync_product' (C:\startup\supersearch\app\models\sync_product.py)
2025-03-09 16:26:55,683 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-09 16:27:06,781 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-09 16:27:06,782 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-09 16:27:06,797 [INFO] Connected to Temporal server
2025-03-09 16:27:06,797 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-09 16:27:08,930 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-09 16:27:08,930 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-09 16:27:08,930 [INFO] Started worker with task queue product-sync-task-queue
2025-03-09 17:03:04,217 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-09 17:03:04,217 [INFO] Getting products from manual file upload
2025-03-09 17:03:05,686 [INFO] Total embedding process completed in 1.299s
2025-03-09 17:03:06,199 [INFO] Total embedding process completed in 0.513s
2025-03-09 17:03:06,706 [INFO] Total embedding process completed in 0.507s
2025-03-09 17:03:07,316 [INFO] Total embedding process completed in 0.609s
2025-03-09 17:03:07,813 [INFO] Total embedding process completed in 0.497s
2025-03-09 17:03:08,143 [INFO] Total embedding process completed in 0.328s
2025-03-09 17:03:08,143 [INFO] Retrieved 6 products from source: MANUAL_FILE_UPLOAD
2025-03-09 17:03:08,371 [INFO] Inserting 6 products into database
2025-03-09 17:03:08,610 [INFO] Inserted 6 products into database
2025-03-09 17:03:08,728 [INFO] Updating sync history record with ID: 6830c6bd-b56b-4977-9d22-7062d9bbe0f1
2025-03-09 17:03:08,776 [INFO] Updated sync history record with ID: 6830c6bd-b56b-4977-9d22-7062d9bbe0f1
2025-03-10 01:08:32,962 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-10 01:08:45,973 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-10 01:08:45,974 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-10 01:08:46,104 [INFO] Connected to Temporal server
2025-03-10 01:08:46,104 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-10 01:08:50,425 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-10 01:08:50,425 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-10 01:08:50,425 [INFO] Started worker with task queue product-sync-task-queue
2025-03-10 01:28:49,426 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-10 01:28:59,731 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-10 01:28:59,731 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-10 01:28:59,757 [INFO] Connected to Temporal server
2025-03-10 01:28:59,757 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-10 01:29:04,805 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-10 01:29:04,805 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-10 01:29:04,805 [INFO] Started worker with task queue product-sync-task-queue
2025-03-10 01:37:11,469 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-10 01:37:20,451 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-10 01:37:20,451 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-10 01:37:20,477 [INFO] Connected to Temporal server
2025-03-10 01:37:20,479 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-10 01:37:24,469 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-10 01:37:24,471 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-10 01:37:24,471 [INFO] Started worker with task queue product-sync-task-queue
2025-03-10 02:57:44,959 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-10 02:57:54,018 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-10 02:57:54,022 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-10 02:57:54,040 [INFO] Connected to Temporal server
2025-03-10 02:57:54,040 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-10 02:57:58,580 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-10 02:57:58,580 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-10 02:57:58,588 [INFO] Started worker with task queue product-sync-task-queue
2025-03-11 00:53:47,236 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-11 00:54:03,996 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-11 00:54:03,997 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-11 00:54:04,089 [INFO] Connected to Temporal server
2025-03-11 00:54:04,089 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-11 00:54:06,246 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-11 00:54:06,246 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-11 00:54:06,246 [INFO] Started worker with task queue product-sync-task-queue
2025-03-11 01:08:40,721 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-11 01:14:22,930 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-11 01:14:22,931 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-11 01:14:23,028 [INFO] Connected to Temporal server
2025-03-11 01:14:23,028 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-11 01:14:24,684 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-11 01:14:24,685 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-11 01:14:24,685 [INFO] Started worker with task queue product-sync-task-queue
2025-03-11 01:16:11,458 [INFO] Getting products from source: MANUAL_FILE_UPLOAD
2025-03-11 01:16:11,458 [INFO] Getting products from manual file upload
2025-03-11 01:16:13,132 [INFO] Total embedding process completed in 1.304s
2025-03-11 01:16:13,941 [INFO] Total embedding process completed in 0.810s
2025-03-11 01:16:14,738 [INFO] Total embedding process completed in 0.797s
2025-03-11 01:16:14,738 [INFO] Retrieved 3 products from source: MANUAL_FILE_UPLOAD
2025-03-11 01:16:14,803 [INFO] Inserting 3 products into database
2025-03-11 01:16:14,954 [INFO] Inserted 3 products into database
2025-03-11 01:16:15,033 [INFO] Updating sync history record with ID: 591eee4b-a7f9-413e-a308-5bae5b40e19c
2025-03-11 01:16:15,070 [INFO] Updated sync history record with ID: 591eee4b-a7f9-413e-a308-5bae5b40e19c
2025-03-11 01:23:52,618 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
2025-03-11 01:24:02,647 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-11 01:24:02,648 [INFO] Connecting to Temporal server at localhost:7233 with namespace default
2025-03-11 01:24:02,692 [INFO] Connected to Temporal server
2025-03-11 01:24:02,692 [INFO] Creating worker for task queue: product-sync-task-queue
2025-03-11 01:24:03,639 [INFO] Worker created for task queue: product-sync-task-queue
2025-03-11 01:24:03,639 [INFO] Starting worker for task queue: product-sync-task-queue
2025-03-11 01:24:03,639 [INFO] Started worker with task queue product-sync-task-queue
2025-03-11 02:09:28,306 [INFO] Beginning worker shutdown, will wait 0:00:00 before cancelling activities
